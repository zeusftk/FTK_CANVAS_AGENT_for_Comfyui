import{w as j,x as y,l as x,j as e,D as f,y as D,o as d,T as g,z as C,s as N,t as w,A as b,F as S,r as p,G as m,I as T,v as h,H as _,J as v,K as L,L as M,S as I,M as P,N as E}from"./index-DNT9Vl18.js";import{d as F,l as O,u as k,C as A,n as u,c as H}from"./index.browser-Wncyp79h.js";import{T as z}from"./TopMenu-CGgZSjXt.js";function G(i){return j({select:a=>a.location})}function R(i){if(!i)return"";const a=new Date(i),s=y.language||"en";return a.toLocaleString(s,{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}const $=({show:i,className:a,children:s,setShow:t,handleDeleteCanvas:l})=>{const{t:o}=x();return e.jsxs(f,{open:i,onOpenChange:t,children:[e.jsx(D,{asChild:!0,children:s||e.jsx(d,{variant:"destructive",size:"icon",className:a,children:e.jsx(g,{className:"w-4 h-4"})})}),e.jsxs(C,{open:i,children:[e.jsx(N,{children:e.jsx(w,{children:o("canvas:deleteDialog.title")})}),e.jsx(b,{children:o("canvas:deleteDialog.description")}),e.jsxs(S,{children:[e.jsx(d,{variant:"outline",onClick:()=>t(!1),children:o("canvas:deleteDialog.cancel")}),e.jsx(d,{variant:"destructive",onClick:()=>l(),children:o("canvas:deleteDialog.delete")})]})]})]})},q=({index:i,canvas:a,handleCanvasClick:s,handleDeleteCanvas:t})=>{const{t:l}=x(),[o,c]=p.useState(!1),n=async()=>{try{await F(a.id),t(),h.success(l("canvas:messages.canvasDeleted"))}catch{h.error(l("canvas:messages.failedToDelete"))}c(!1)};return e.jsxs(m.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:i*.1},className:"border border-primary/20 rounded-xl cursor-pointer hover:border-primary/40 transition-all duration-300 hover:shadow-md hover:bg-primary/5 active:scale-99 relative group",children:[e.jsx($,{show:o,setShow:c,handleDeleteCanvas:n,children:e.jsx(d,{variant:"secondary",size:"icon",className:"absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:e.jsx(g,{className:"w-4 h-4"})})}),e.jsxs("div",{className:"p-3 flex flex-col gap-2",onClick:()=>s(a.id),children:[a.thumbnail?e.jsx("img",{src:a.thumbnail,alt:a.name,className:"w-full h-40 object-cover rounded-lg"}):e.jsx("div",{className:"w-full h-40 bg-primary/10 rounded-lg flex items-center justify-center",children:e.jsx(T,{className:"w-10 h-10 opacity-10"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h3",{className:"text-lg font-bold",children:a.name}),e.jsx("p",{className:"text-sm text-gray-500",children:R(a.created_at)})]})]})]})},K=()=>{const{t:i}=x(),s=G().pathname==="/",{data:t,refetch:l}=_({queryKey:["canvases"],queryFn:O,enabled:s,refetchOnMount:"always"}),o=v(),c=n=>{o({to:"/canvas/$id",params:{id:n}})};return e.jsxs("div",{className:"flex flex-col px-10 mt-10 gap-4 select-none max-w-[1200px] mx-auto",children:[t&&t.length>0&&e.jsx(m.span,{className:"text-2xl font-bold",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.5},children:i("home:allProjects")}),e.jsx(L,{children:e.jsx("div",{className:"grid grid-cols-4 gap-4 w-full pb-10",children:t==null?void 0:t.map((n,r)=>e.jsx(q,{index:r,canvas:n,handleCanvasClick:c,handleDeleteCanvas:()=>l()},n.id))})})]})},B=p.memo(K),Y=function(){const a=v(),{t:s}=x(),{setInitCanvas:t,setShowLoginDialog:l}=M(),{mutate:o,isPending:c}=k({mutationFn:H,onSuccess:(n,r)=>{t(!0),a({to:"/canvas/$id",params:{id:n.id},search:{sessionId:r.session_id}})},onError:n=>{h.error(s("common:messages.error"),{description:n.message})}});return e.jsx("div",{className:"flex flex-col h-screen",children:e.jsxs(I,{className:"h-full",children:[e.jsx(z,{}),e.jsxs("div",{className:"relative flex flex-col items-center justify-center h-fit min-h-[calc(100vh-460px)] pt-[60px] select-none",children:[e.jsx(m.div,{children:e.jsx("img",{src:P,alt:"Logo",className:"w-64 h-64 mx-auto mb-4",draggable:!1,style:{width:"168px",height:"168px"}})}),e.jsx(m.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.5},children:e.jsx("p",{className:"text-xl text-gray-500 mb-8 text-center",children:s("home:subtitle")})}),e.jsx(A,{className:"w-full max-w-xl",messages:[],onSendMessages:(n,r)=>{o({name:s("home:newCanvas"),canvas_id:u(),messages:n,session_id:u(),text_model:r.textModel,tool_list:r.toolList,system_prompt:localStorage.getItem("system_prompt")||E})},pending:c})]}),e.jsx(B,{})]})})};export{Y as component};
