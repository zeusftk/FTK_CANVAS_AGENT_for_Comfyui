import{c as Bt,ad as gr,ae as pr,r as $,j as E,o as bt,af as vt,i as mr}from"./index-DNT9Vl18.js";import{s as ie,f as Zn,g as Rt,T as Et,h as St,t as yr}from"./transform-KKRXlpDu.js";import{i as Nt}from"./value-BLgvJGK3.js";import{x as xr}from"./index-Yce1s99O.js";import{T as wr}from"./TopMenu-CGgZSjXt.js";/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const br=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],vr=Bt("book-open",br);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Er=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],Sr=Bt("bot",Er);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nr=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]],rn=Bt("wrench",Nr);function re(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,o;n<e.length;n++)(o=re(e[n]))!==""&&(t+=(t&&" ")+o);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}function Cr(e){let t;for(;t=e.sourceEvent;)e=t;return e}function ae(e,t){if(e=Cr(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var o=n.createSVGPoint();return o.x=e.clientX,o.y=e.clientY,o=o.matrixTransform(t.getScreenCTM().inverse()),[o.x,o.y]}if(t.getBoundingClientRect){var s=t.getBoundingClientRect();return[e.clientX-s.left-t.clientLeft,e.clientY-s.top-t.clientTop]}}return[e.pageX,e.pageY]}const Mr={passive:!1},Le={capture:!0,passive:!1};function Ct(e){e.stopImmediatePropagation()}function Ce(e){e.preventDefault(),e.stopImmediatePropagation()}function qn(e){var t=e.document.documentElement,n=ie(e).on("dragstart.drag",Ce,Le);"onselectstart"in t?n.on("selectstart.drag",Ce,Le):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Un(e,t){var n=e.document.documentElement,o=ie(e).on("dragstart.drag",null);t&&(o.on("click.drag",Ce,Le),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in n?o.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const qe=e=>()=>e;function At(e,{sourceEvent:t,subject:n,target:o,identifier:s,active:r,x:i,y:a,dx:l,dy:g,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:r,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:g,enumerable:!0,configurable:!0},_:{value:u}})}At.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function kr(e){return!e.ctrlKey&&!e.button}function Ir(){return this.parentNode}function _r(e,t){return t??{x:e.x,y:e.y}}function Pr(){return navigator.maxTouchPoints||"ontouchstart"in this}function Qn(){var e=kr,t=Ir,n=_r,o=Pr,s={},r=Zn("start","drag","end"),i=0,a,l,g,u,d=0;function c(w){w.on("mousedown.drag",h).filter(o).on("touchstart.drag",b).on("touchmove.drag",m,Mr).on("touchend.drag touchcancel.drag",N).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(w,v){if(!(u||!e.call(this,w,v))){var I=f(this,t.call(this,w,v),w,v,"mouse");I&&(ie(w.view).on("mousemove.drag",y,Le).on("mouseup.drag",p,Le),qn(w.view),Ct(w),g=!1,a=w.clientX,l=w.clientY,I("start",w))}}function y(w){if(Ce(w),!g){var v=w.clientX-a,I=w.clientY-l;g=v*v+I*I>d}s.mouse("drag",w)}function p(w){ie(w.view).on("mousemove.drag mouseup.drag",null),Un(w.view,g),Ce(w),s.mouse("end",w)}function b(w,v){if(e.call(this,w,v)){var I=w.changedTouches,_=t.call(this,w,v),P=I.length,j,B;for(j=0;j<P;++j)(B=f(this,_,w,v,I[j].identifier,I[j]))&&(Ct(w),B("start",w,I[j]))}}function m(w){var v=w.changedTouches,I=v.length,_,P;for(_=0;_<I;++_)(P=s[v[_].identifier])&&(Ce(w),P("drag",w,v[_]))}function N(w){var v=w.changedTouches,I=v.length,_,P;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),_=0;_<I;++_)(P=s[v[_].identifier])&&(Ct(w),P("end",w,v[_]))}function f(w,v,I,_,P,j){var B=r.copy(),A=ae(j||I,v),L,H,x;if((x=n.call(w,new At("beforestart",{sourceEvent:I,target:c,identifier:P,active:i,x:A[0],y:A[1],dx:0,dy:0,dispatch:B}),_))!=null)return L=x.x-A[0]||0,H=x.y-A[1]||0,function C(S,M,z){var k=A,T;switch(S){case"start":s[P]=C,T=i++;break;case"end":delete s[P],--i;case"drag":A=ae(z||M,v),T=i;break}B.call(S,w,new At(S,{sourceEvent:M,subject:x,target:c,identifier:P,active:T,x:A[0]+L,y:A[1]+H,dx:A[0]-k[0],dy:A[1]-k[1],dispatch:B}),_)}}return c.filter=function(w){return arguments.length?(e=typeof w=="function"?w:qe(!!w),c):e},c.container=function(w){return arguments.length?(t=typeof w=="function"?w:qe(w),c):t},c.subject=function(w){return arguments.length?(n=typeof w=="function"?w:qe(w),c):n},c.touchable=function(w){return arguments.length?(o=typeof w=="function"?w:qe(!!w),c):o},c.on=function(){var w=r.on.apply(r,arguments);return w===r?c:w},c.clickDistance=function(w){return arguments.length?(d=(w=+w)*w,c):Math.sqrt(d)},c}var $r=1e-12;function an(e){return((e=Math.exp(e))+1/e)/2}function Ar(e){return((e=Math.exp(e))-1/e)/2}function zr(e){return((e=Math.exp(2*e))-1)/(e+1)}const nt=function e(t,n,o){function s(r,i){var a=r[0],l=r[1],g=r[2],u=i[0],d=i[1],c=i[2],h=u-a,y=d-l,p=h*h+y*y,b,m;if(p<$r)m=Math.log(c/g)/t,b=function(_){return[a+_*h,l+_*y,g*Math.exp(t*_*m)]};else{var N=Math.sqrt(p),f=(c*c-g*g+o*p)/(2*g*n*N),w=(c*c-g*g-o*p)/(2*c*n*N),v=Math.log(Math.sqrt(f*f+1)-f),I=Math.log(Math.sqrt(w*w+1)-w);m=(I-v)/t,b=function(_){var P=_*m,j=an(v),B=g/(n*N)*(j*zr(t*P+v)-Ar(v));return[a+B*h,l+B*y,g*j/an(t*P+v)]}}return b.duration=m*1e3*t/Math.SQRT2,b}return s.rho=function(r){var i=Math.max(.001,+r),a=i*i,l=a*a;return e(i,a,l)},s}(Math.SQRT2,2,4),Ue=e=>()=>e;function Tr(e,{sourceEvent:t,target:n,transform:o,dispatch:s}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:s}})}function Mt(e){e.stopImmediatePropagation()}function Te(e){e.preventDefault(),e.stopImmediatePropagation()}function jr(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Lr(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function cn(){return this.__zoom||Rt}function Hr(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Dr(){return navigator.maxTouchPoints||"ontouchstart"in this}function Br(e,t,n){var o=e.invertX(t[0][0])-n[0][0],s=e.invertX(t[1][0])-n[1][0],r=e.invertY(t[0][1])-n[0][1],i=e.invertY(t[1][1])-n[1][1];return e.translate(s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s),i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i))}function Jn(){var e=jr,t=Lr,n=Br,o=Hr,s=Dr,r=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],a=250,l=nt,g=Zn("start","zoom","end"),u,d,c,h=500,y=150,p=0,b=10;function m(x){x.property("__zoom",cn).on("wheel.zoom",P,{passive:!1}).on("mousedown.zoom",j).on("dblclick.zoom",B).filter(s).on("touchstart.zoom",A).on("touchmove.zoom",L).on("touchend.zoom touchcancel.zoom",H).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}m.transform=function(x,C,S,M){var z=x.selection?x.selection():x;z.property("__zoom",cn),x!==z?v(x,C,S,M):z.interrupt().each(function(){I(this,arguments).event(M).start().zoom(null,typeof C=="function"?C.apply(this,arguments):C).end()})},m.scaleBy=function(x,C,S,M){m.scaleTo(x,function(){var z=this.__zoom.k,k=typeof C=="function"?C.apply(this,arguments):C;return z*k},S,M)},m.scaleTo=function(x,C,S,M){m.transform(x,function(){var z=t.apply(this,arguments),k=this.__zoom,T=S==null?w(z):typeof S=="function"?S.apply(this,arguments):S,D=k.invert(T),R=typeof C=="function"?C.apply(this,arguments):C;return n(f(N(k,R),T,D),z,i)},S,M)},m.translateBy=function(x,C,S,M){m.transform(x,function(){return n(this.__zoom.translate(typeof C=="function"?C.apply(this,arguments):C,typeof S=="function"?S.apply(this,arguments):S),t.apply(this,arguments),i)},null,M)},m.translateTo=function(x,C,S,M,z){m.transform(x,function(){var k=t.apply(this,arguments),T=this.__zoom,D=M==null?w(k):typeof M=="function"?M.apply(this,arguments):M;return n(Rt.translate(D[0],D[1]).scale(T.k).translate(typeof C=="function"?-C.apply(this,arguments):-C,typeof S=="function"?-S.apply(this,arguments):-S),k,i)},M,z)};function N(x,C){return C=Math.max(r[0],Math.min(r[1],C)),C===x.k?x:new Et(C,x.x,x.y)}function f(x,C,S){var M=C[0]-S[0]*x.k,z=C[1]-S[1]*x.k;return M===x.x&&z===x.y?x:new Et(x.k,M,z)}function w(x){return[(+x[0][0]+ +x[1][0])/2,(+x[0][1]+ +x[1][1])/2]}function v(x,C,S,M){x.on("start.zoom",function(){I(this,arguments).event(M).start()}).on("interrupt.zoom end.zoom",function(){I(this,arguments).event(M).end()}).tween("zoom",function(){var z=this,k=arguments,T=I(z,k).event(M),D=t.apply(z,k),R=S==null?w(D):typeof S=="function"?S.apply(z,k):S,O=Math.max(D[1][0]-D[0][0],D[1][1]-D[0][1]),V=z.__zoom,X=typeof C=="function"?C.apply(z,k):C,G=l(V.invert(R).concat(O/V.k),X.invert(R).concat(O/X.k));return function(Y){if(Y===1)Y=X;else{var F=G(Y),K=O/F[2];Y=new Et(K,R[0]-F[0]*K,R[1]-F[1]*K)}T.zoom(null,Y)}})}function I(x,C,S){return!S&&x.__zooming||new _(x,C)}function _(x,C){this.that=x,this.args=C,this.active=0,this.sourceEvent=null,this.extent=t.apply(x,C),this.taps=0}_.prototype={event:function(x){return x&&(this.sourceEvent=x),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(x,C){return this.mouse&&x!=="mouse"&&(this.mouse[1]=C.invert(this.mouse[0])),this.touch0&&x!=="touch"&&(this.touch0[1]=C.invert(this.touch0[0])),this.touch1&&x!=="touch"&&(this.touch1[1]=C.invert(this.touch1[0])),this.that.__zoom=C,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(x){var C=ie(this.that).datum();g.call(x,this.that,new Tr(x,{sourceEvent:this.sourceEvent,target:m,transform:this.that.__zoom,dispatch:g}),C)}};function P(x,...C){if(!e.apply(this,arguments))return;var S=I(this,C).event(x),M=this.__zoom,z=Math.max(r[0],Math.min(r[1],M.k*Math.pow(2,o.apply(this,arguments)))),k=ae(x);if(S.wheel)(S.mouse[0][0]!==k[0]||S.mouse[0][1]!==k[1])&&(S.mouse[1]=M.invert(S.mouse[0]=k)),clearTimeout(S.wheel);else{if(M.k===z)return;S.mouse=[k,M.invert(k)],St(this),S.start()}Te(x),S.wheel=setTimeout(T,y),S.zoom("mouse",n(f(N(M,z),S.mouse[0],S.mouse[1]),S.extent,i));function T(){S.wheel=null,S.end()}}function j(x,...C){if(c||!e.apply(this,arguments))return;var S=x.currentTarget,M=I(this,C,!0).event(x),z=ie(x.view).on("mousemove.zoom",R,!0).on("mouseup.zoom",O,!0),k=ae(x,S),T=x.clientX,D=x.clientY;qn(x.view),Mt(x),M.mouse=[k,this.__zoom.invert(k)],St(this),M.start();function R(V){if(Te(V),!M.moved){var X=V.clientX-T,G=V.clientY-D;M.moved=X*X+G*G>p}M.event(V).zoom("mouse",n(f(M.that.__zoom,M.mouse[0]=ae(V,S),M.mouse[1]),M.extent,i))}function O(V){z.on("mousemove.zoom mouseup.zoom",null),Un(V.view,M.moved),Te(V),M.event(V).end()}}function B(x,...C){if(e.apply(this,arguments)){var S=this.__zoom,M=ae(x.changedTouches?x.changedTouches[0]:x,this),z=S.invert(M),k=S.k*(x.shiftKey?.5:2),T=n(f(N(S,k),M,z),t.apply(this,C),i);Te(x),a>0?ie(this).transition().duration(a).call(v,T,M,x):ie(this).call(m.transform,T,M,x)}}function A(x,...C){if(e.apply(this,arguments)){var S=x.touches,M=S.length,z=I(this,C,x.changedTouches.length===M).event(x),k,T,D,R;for(Mt(x),T=0;T<M;++T)D=S[T],R=ae(D,this),R=[R,this.__zoom.invert(R),D.identifier],z.touch0?!z.touch1&&z.touch0[2]!==R[2]&&(z.touch1=R,z.taps=0):(z.touch0=R,k=!0,z.taps=1+!!u);u&&(u=clearTimeout(u)),k&&(z.taps<2&&(d=R[0],u=setTimeout(function(){u=null},h)),St(this),z.start())}}function L(x,...C){if(this.__zooming){var S=I(this,C).event(x),M=x.changedTouches,z=M.length,k,T,D,R;for(Te(x),k=0;k<z;++k)T=M[k],D=ae(T,this),S.touch0&&S.touch0[2]===T.identifier?S.touch0[0]=D:S.touch1&&S.touch1[2]===T.identifier&&(S.touch1[0]=D);if(T=S.that.__zoom,S.touch1){var O=S.touch0[0],V=S.touch0[1],X=S.touch1[0],G=S.touch1[1],Y=(Y=X[0]-O[0])*Y+(Y=X[1]-O[1])*Y,F=(F=G[0]-V[0])*F+(F=G[1]-V[1])*F;T=N(T,Math.sqrt(Y/F)),D=[(O[0]+X[0])/2,(O[1]+X[1])/2],R=[(V[0]+G[0])/2,(V[1]+G[1])/2]}else if(S.touch0)D=S.touch0[0],R=S.touch0[1];else return;S.zoom("touch",n(f(T,D,R),S.extent,i))}}function H(x,...C){if(this.__zooming){var S=I(this,C).event(x),M=x.changedTouches,z=M.length,k,T;for(Mt(x),c&&clearTimeout(c),c=setTimeout(function(){c=null},h),k=0;k<z;++k)T=M[k],S.touch0&&S.touch0[2]===T.identifier?delete S.touch0:S.touch1&&S.touch1[2]===T.identifier&&delete S.touch1;if(S.touch1&&!S.touch0&&(S.touch0=S.touch1,delete S.touch1),S.touch0)S.touch0[1]=this.__zoom.invert(S.touch0[0]);else if(S.end(),S.taps===2&&(T=ae(T,this),Math.hypot(d[0]-T[0],d[1]-T[1])<b)){var D=ie(this).on("dblclick.zoom");D&&D.apply(this,arguments)}}}return m.wheelDelta=function(x){return arguments.length?(o=typeof x=="function"?x:Ue(+x),m):o},m.filter=function(x){return arguments.length?(e=typeof x=="function"?x:Ue(!!x),m):e},m.touchable=function(x){return arguments.length?(s=typeof x=="function"?x:Ue(!!x),m):s},m.extent=function(x){return arguments.length?(t=typeof x=="function"?x:Ue([[+x[0][0],+x[0][1]],[+x[1][0],+x[1][1]]]),m):t},m.scaleExtent=function(x){return arguments.length?(r[0]=+x[0],r[1]=+x[1],m):[r[0],r[1]]},m.translateExtent=function(x){return arguments.length?(i[0][0]=+x[0][0],i[1][0]=+x[1][0],i[0][1]=+x[0][1],i[1][1]=+x[1][1],m):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},m.constrain=function(x){return arguments.length?(n=x,m):n},m.duration=function(x){return arguments.length?(a=+x,m):a},m.interpolate=function(x){return arguments.length?(l=x,m):l},m.on=function(){var x=g.on.apply(g,arguments);return x===g?m:x},m.clickDistance=function(x){return arguments.length?(p=(x=+x)*x,m):Math.sqrt(p)},m.tapDistance=function(x){return arguments.length?(b=+x,m):b},m}const ue={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:o})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:o}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},He=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],eo=["Enter"," ","Escape"],to={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:e,x:t,y:n})=>`Moved selected node ${e}. New position, x: ${t}, y: ${n}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var Me;(function(e){e.Strict="strict",e.Loose="loose"})(Me||(Me={}));var xe;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(xe||(xe={}));var De;(function(e){e.Partial="partial",e.Full="full"})(De||(De={}));const no={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var pe;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(pe||(pe={}));var ot;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(ot||(ot={}));var W;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(W||(W={}));const ln={[W.Left]:W.Right,[W.Right]:W.Left,[W.Top]:W.Bottom,[W.Bottom]:W.Top};function oo(e){return e===null?null:e?"valid":"invalid"}const so=e=>"id"in e&&"source"in e&&"target"in e,Rr=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),Vt=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),Fe=(e,t=[0,0])=>{const{width:n,height:o}=fe(e),s=e.origin??t,r=n*s[0],i=o*s[1];return{x:e.position.x-r,y:e.position.y-i}},Vr=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((o,s)=>{const r=typeof s=="string";let i=!t.nodeLookup&&!r?s:void 0;t.nodeLookup&&(i=r?t.nodeLookup.get(s):Vt(s)?s:t.nodeLookup.get(s.id));const a=i?st(i,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return lt(o,a)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return ut(n)},Oe=(e,t={})=>{if(e.size===0)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(o=>{if(t.filter===void 0||t.filter(o)){const s=st(o);n=lt(n,s)}}),ut(n)},Ft=(e,t,[n,o,s]=[0,0,1],r=!1,i=!1)=>{const a={...Ye(t,[n,o,s]),width:t.width/s,height:t.height/s},l=[];for(const g of e.values()){const{measured:u,selectable:d=!0,hidden:c=!1}=g;if(i&&!d||c)continue;const h=u.width??g.width??g.initialWidth??null,y=u.height??g.height??g.initialHeight??null,p=Be(a,Ie(g)),b=(h??0)*(y??0),m=r&&p>0;(!g.internals.handleBounds||m||p>=b||g.dragging)&&l.push(g)}return l},Fr=(e,t)=>{const n=new Set;return e.forEach(o=>{n.add(o.id)}),t.filter(o=>n.has(o.source)||n.has(o.target))};function Or(e,t){const n=new Map,o=t!=null&&t.nodes?new Set(t.nodes.map(s=>s.id)):null;return e.forEach(s=>{s.measured.width&&s.measured.height&&((t==null?void 0:t.includeHiddenNodes)||!s.hidden)&&(!o||o.has(s.id))&&n.set(s.id,s)}),n}async function Yr({nodes:e,width:t,height:n,panZoom:o,minZoom:s,maxZoom:r},i){if(e.size===0)return Promise.resolve(!0);const a=Or(e,i),l=Oe(a),g=Ot(l,t,n,(i==null?void 0:i.minZoom)??s,(i==null?void 0:i.maxZoom)??r,(i==null?void 0:i.padding)??.1);return await o.setViewport(g,{duration:i==null?void 0:i.duration,ease:i==null?void 0:i.ease,interpolate:i==null?void 0:i.interpolate}),Promise.resolve(!0)}function ro({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:o=[0,0],nodeExtent:s,onError:r}){const i=n.get(e),a=i.parentId?n.get(i.parentId):void 0,{x:l,y:g}=a?a.internals.positionAbsolute:{x:0,y:0},u=i.origin??o;let d=i.extent||s;if(i.extent==="parent"&&!i.expandParent)if(!a)r==null||r("005",ue.error005());else{const h=a.measured.width,y=a.measured.height;h&&y&&(d=[[l,g],[l+h,g+y]])}else a&&_e(i.extent)&&(d=[[i.extent[0][0]+l,i.extent[0][1]+g],[i.extent[1][0]+l,i.extent[1][1]+g]]);const c=_e(d)?we(t,d,i.measured):t;return(i.measured.width===void 0||i.measured.height===void 0)&&(r==null||r("015",ue.error015())),{position:{x:c.x-l+(i.measured.width??0)*u[0],y:c.y-g+(i.measured.height??0)*u[1]},positionAbsolute:c}}async function Xr({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:o,onBeforeDelete:s}){const r=new Set(e.map(c=>c.id)),i=[];for(const c of n){if(c.deletable===!1)continue;const h=r.has(c.id),y=!h&&c.parentId&&i.find(p=>p.id===c.parentId);(h||y)&&i.push(c)}const a=new Set(t.map(c=>c.id)),l=o.filter(c=>c.deletable!==!1),u=Fr(i,l);for(const c of l)a.has(c.id)&&!u.find(y=>y.id===c.id)&&u.push(c);if(!s)return{edges:u,nodes:i};const d=await s({nodes:i,edges:u});return typeof d=="boolean"?d?{edges:u,nodes:i}:{edges:[],nodes:[]}:d}const ke=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),we=(e={x:0,y:0},t,n)=>({x:ke(e.x,t[0][0],t[1][0]-((n==null?void 0:n.width)??0)),y:ke(e.y,t[0][1],t[1][1]-((n==null?void 0:n.height)??0))});function io(e,t,n){const{width:o,height:s}=fe(n),{x:r,y:i}=n.internals.positionAbsolute;return we(e,[[r,i],[r+o,i+s]],t)}const un=(e,t,n)=>e<t?ke(Math.abs(e-t),1,t)/t:e>n?-ke(Math.abs(e-n),1,t)/t:0,ao=(e,t,n=15,o=40)=>{const s=un(e.x,o,t.width-o)*n,r=un(e.y,o,t.height-o)*n;return[s,r]},lt=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),zt=({x:e,y:t,width:n,height:o})=>({x:e,y:t,x2:e+n,y2:t+o}),ut=({x:e,y:t,x2:n,y2:o})=>({x:e,y:t,width:n-e,height:o-t}),Ie=(e,t=[0,0])=>{var s,r;const{x:n,y:o}=Vt(e)?e.internals.positionAbsolute:Fe(e,t);return{x:n,y:o,width:((s=e.measured)==null?void 0:s.width)??e.width??e.initialWidth??0,height:((r=e.measured)==null?void 0:r.height)??e.height??e.initialHeight??0}},st=(e,t=[0,0])=>{var s,r;const{x:n,y:o}=Vt(e)?e.internals.positionAbsolute:Fe(e,t);return{x:n,y:o,x2:n+(((s=e.measured)==null?void 0:s.width)??e.width??e.initialWidth??0),y2:o+(((r=e.measured)==null?void 0:r.height)??e.height??e.initialHeight??0)}},co=(e,t)=>ut(lt(zt(e),zt(t))),Be=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*o)},dn=e=>ce(e.width)&&ce(e.height)&&ce(e.x)&&ce(e.y),ce=e=>!isNaN(e)&&isFinite(e),Wr=(e,t)=>{},dt=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),Ye=({x:e,y:t},[n,o,s],r=!1,i=[1,1])=>{const a={x:(e-n)/s,y:(t-o)/s};return r?dt(a,i):a},rt=({x:e,y:t},[n,o,s])=>({x:e*s+n,y:t*s+o});function Ee(e,t){if(typeof e=="number")return Math.floor((t-t/(1+e))*.5);if(typeof e=="string"&&e.endsWith("px")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(n)}if(typeof e=="string"&&e.endsWith("%")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function Gr(e,t,n){if(typeof e=="string"||typeof e=="number"){const o=Ee(e,n),s=Ee(e,t);return{top:o,right:s,bottom:o,left:s,x:s*2,y:o*2}}if(typeof e=="object"){const o=Ee(e.top??e.y??0,n),s=Ee(e.bottom??e.y??0,n),r=Ee(e.left??e.x??0,t),i=Ee(e.right??e.x??0,t);return{top:o,right:i,bottom:s,left:r,x:r+i,y:o+s}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function Kr(e,t,n,o,s,r){const{x:i,y:a}=rt(e,[t,n,o]),{x:l,y:g}=rt({x:e.x+e.width,y:e.y+e.height},[t,n,o]),u=s-l,d=r-g;return{left:Math.floor(i),top:Math.floor(a),right:Math.floor(u),bottom:Math.floor(d)}}const Ot=(e,t,n,o,s,r)=>{const i=Gr(r,t,n),a=(t-i.x)/e.width,l=(n-i.y)/e.height,g=Math.min(a,l),u=ke(g,o,s),d=e.x+e.width/2,c=e.y+e.height/2,h=t/2-d*u,y=n/2-c*u,p=Kr(e,h,y,u,t,n),b={left:Math.min(p.left-i.left,0),top:Math.min(p.top-i.top,0),right:Math.min(p.right-i.right,0),bottom:Math.min(p.bottom-i.bottom,0)};return{x:h-b.left+b.right,y:y-b.top+b.bottom,zoom:u}},it=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function _e(e){return e!==void 0&&e!=="parent"}function fe(e){var t,n;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight??0}}function lo(e){var t,n;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight)!==void 0}function uo(e,t={width:0,height:0},n,o,s){const r={...e},i=o.get(n);if(i){const a=i.origin||s;r.x+=i.internals.positionAbsolute.x-(t.width??0)*a[0],r.y+=i.internals.positionAbsolute.y-(t.height??0)*a[1]}return r}function fn(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function Zr(){let e,t;return{promise:new Promise((o,s)=>{e=o,t=s}),resolve:e,reject:t}}function qr(e){return{...to,...e||{}}}function je(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:o,containerBounds:s}){const{x:r,y:i}=le(e),a=Ye({x:r-((s==null?void 0:s.left)??0),y:i-((s==null?void 0:s.top)??0)},o),{x:l,y:g}=n?dt(a,t):a;return{xSnapped:l,ySnapped:g,...a}}const Yt=e=>({width:e.offsetWidth,height:e.offsetHeight}),fo=e=>{var t;return((t=e==null?void 0:e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},Ur=["INPUT","SELECT","TEXTAREA"];function ho(e){var o,s;const t=((s=(o=e.composedPath)==null?void 0:o.call(e))==null?void 0:s[0])||e.target;return(t==null?void 0:t.nodeType)!==1?!1:Ur.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const go=e=>"clientX"in e,le=(e,t)=>{var r,i;const n=go(e),o=n?e.clientX:(r=e.touches)==null?void 0:r[0].clientX,s=n?e.clientY:(i=e.touches)==null?void 0:i[0].clientY;return{x:o-((t==null?void 0:t.left)??0),y:s-((t==null?void 0:t.top)??0)}},hn=(e,t,n,o,s)=>{const r=t.querySelectorAll(`.${e}`);return!r||!r.length?null:Array.from(r).map(i=>{const a=i.getBoundingClientRect();return{id:i.getAttribute("data-handleid"),type:e,nodeId:s,position:i.getAttribute("data-handlepos"),x:(a.left-n.left)/o,y:(a.top-n.top)/o,...Yt(i)}})};function po({sourceX:e,sourceY:t,targetX:n,targetY:o,sourceControlX:s,sourceControlY:r,targetControlX:i,targetControlY:a}){const l=e*.125+s*.375+i*.375+n*.125,g=t*.125+r*.375+a*.375+o*.125,u=Math.abs(l-e),d=Math.abs(g-t);return[l,g,u,d]}function Qe(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function gn({pos:e,x1:t,y1:n,x2:o,y2:s,c:r}){switch(e){case W.Left:return[t-Qe(t-o,r),n];case W.Right:return[t+Qe(o-t,r),n];case W.Top:return[t,n-Qe(n-s,r)];case W.Bottom:return[t,n+Qe(s-n,r)]}}function mo({sourceX:e,sourceY:t,sourcePosition:n=W.Bottom,targetX:o,targetY:s,targetPosition:r=W.Top,curvature:i=.25}){const[a,l]=gn({pos:n,x1:e,y1:t,x2:o,y2:s,c:i}),[g,u]=gn({pos:r,x1:o,y1:s,x2:e,y2:t,c:i}),[d,c,h,y]=po({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:a,sourceControlY:l,targetControlX:g,targetControlY:u});return[`M${e},${t} C${a},${l} ${g},${u} ${o},${s}`,d,c,h,y]}function yo({sourceX:e,sourceY:t,targetX:n,targetY:o}){const s=Math.abs(n-e)/2,r=n<e?n+s:n-s,i=Math.abs(o-t)/2,a=o<t?o+i:o-i;return[r,a,s,i]}function Qr({sourceNode:e,targetNode:t,selected:n=!1,zIndex:o,elevateOnSelect:s=!1}){if(o!==void 0)return o;const r=s&&n?1e3:0,i=Math.max(e.parentId?e.internals.z:0,t.parentId?t.internals.z:0);return r+i}function Jr({sourceNode:e,targetNode:t,width:n,height:o,transform:s}){const r=lt(st(e),st(t));r.x===r.x2&&(r.x2+=1),r.y===r.y2&&(r.y2+=1);const i={x:-s[0]/s[2],y:-s[1]/s[2],width:n/s[2],height:o/s[2]};return Be(i,ut(r))>0}const ei=({source:e,sourceHandle:t,target:n,targetHandle:o})=>`xy-edge__${e}${t||""}-${n}${o||""}`,ti=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),xo=(e,t)=>{if(!e.source||!e.target)return t;let n;return so(e)?n={...e}:n={...e,id:ei(e)},ti(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))};function wo({sourceX:e,sourceY:t,targetX:n,targetY:o}){const[s,r,i,a]=yo({sourceX:e,sourceY:t,targetX:n,targetY:o});return[`M ${e},${t}L ${n},${o}`,s,r,i,a]}const pn={[W.Left]:{x:-1,y:0},[W.Right]:{x:1,y:0},[W.Top]:{x:0,y:-1},[W.Bottom]:{x:0,y:1}},ni=({source:e,sourcePosition:t=W.Bottom,target:n})=>t===W.Left||t===W.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},mn=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function oi({source:e,sourcePosition:t=W.Bottom,target:n,targetPosition:o=W.Top,center:s,offset:r,stepPosition:i}){const a=pn[t],l=pn[o],g={x:e.x+a.x*r,y:e.y+a.y*r},u={x:n.x+l.x*r,y:n.y+l.y*r},d=ni({source:g,sourcePosition:t,target:u}),c=d.x!==0?"x":"y",h=d[c];let y=[],p,b;const m={x:0,y:0},N={x:0,y:0},[,,f,w]=yo({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(a[c]*l[c]===-1){c==="x"?(p=s.x??g.x+(u.x-g.x)*i,b=s.y??(g.y+u.y)/2):(p=s.x??(g.x+u.x)/2,b=s.y??g.y+(u.y-g.y)*i);const I=[{x:p,y:g.y},{x:p,y:u.y}],_=[{x:g.x,y:b},{x:u.x,y:b}];a[c]===h?y=c==="x"?I:_:y=c==="x"?_:I}else{const I=[{x:g.x,y:u.y}],_=[{x:u.x,y:g.y}];if(c==="x"?y=a.x===h?_:I:y=a.y===h?I:_,t===o){const L=Math.abs(e[c]-n[c]);if(L<=r){const H=Math.min(r-1,r-L);a[c]===h?m[c]=(g[c]>e[c]?-1:1)*H:N[c]=(u[c]>n[c]?-1:1)*H}}if(t!==o){const L=c==="x"?"y":"x",H=a[c]===l[L],x=g[L]>u[L],C=g[L]<u[L];(a[c]===1&&(!H&&x||H&&C)||a[c]!==1&&(!H&&C||H&&x))&&(y=c==="x"?I:_)}const P={x:g.x+m.x,y:g.y+m.y},j={x:u.x+N.x,y:u.y+N.y},B=Math.max(Math.abs(P.x-y[0].x),Math.abs(j.x-y[0].x)),A=Math.max(Math.abs(P.y-y[0].y),Math.abs(j.y-y[0].y));B>=A?(p=(P.x+j.x)/2,b=y[0].y):(p=y[0].x,b=(P.y+j.y)/2)}return[[e,{x:g.x+m.x,y:g.y+m.y},...y,{x:u.x+N.x,y:u.y+N.y},n],p,b,f,w]}function si(e,t,n,o){const s=Math.min(mn(e,t)/2,mn(t,n)/2,o),{x:r,y:i}=t;if(e.x===r&&r===n.x||e.y===i&&i===n.y)return`L${r} ${i}`;if(e.y===i){const g=e.x<n.x?-1:1,u=e.y<n.y?1:-1;return`L ${r+s*g},${i}Q ${r},${i} ${r},${i+s*u}`}const a=e.x<n.x?1:-1,l=e.y<n.y?-1:1;return`L ${r},${i+s*l}Q ${r},${i} ${r+s*a},${i}`}function Tt({sourceX:e,sourceY:t,sourcePosition:n=W.Bottom,targetX:o,targetY:s,targetPosition:r=W.Top,borderRadius:i=5,centerX:a,centerY:l,offset:g=20,stepPosition:u=.5}){const[d,c,h,y,p]=oi({source:{x:e,y:t},sourcePosition:n,target:{x:o,y:s},targetPosition:r,center:{x:a,y:l},offset:g,stepPosition:u});return[d.reduce((m,N,f)=>{let w="";return f>0&&f<d.length-1?w=si(d[f-1],N,d[f+1],i):w=`${f===0?"M":"L"}${N.x} ${N.y}`,m+=w,m},""),c,h,y,p]}function yn(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function ri(e){var d;const{sourceNode:t,targetNode:n}=e;if(!yn(t)||!yn(n))return null;const o=t.internals.handleBounds||xn(t.handles),s=n.internals.handleBounds||xn(n.handles),r=wn((o==null?void 0:o.source)??[],e.sourceHandle),i=wn(e.connectionMode===Me.Strict?(s==null?void 0:s.target)??[]:((s==null?void 0:s.target)??[]).concat((s==null?void 0:s.source)??[]),e.targetHandle);if(!r||!i)return(d=e.onError)==null||d.call(e,"008",ue.error008(r?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const a=(r==null?void 0:r.position)||W.Bottom,l=(i==null?void 0:i.position)||W.Top,g=Re(t,r,a),u=Re(n,i,l);return{sourceX:g.x,sourceY:g.y,targetX:u.x,targetY:u.y,sourcePosition:a,targetPosition:l}}function xn(e){if(!e)return null;const t=[],n=[];for(const o of e)o.width=o.width??1,o.height=o.height??1,o.type==="source"?t.push(o):o.type==="target"&&n.push(o);return{source:t,target:n}}function Re(e,t,n=W.Left,o=!1){const s=((t==null?void 0:t.x)??0)+e.internals.positionAbsolute.x,r=((t==null?void 0:t.y)??0)+e.internals.positionAbsolute.y,{width:i,height:a}=t??fe(e);if(o)return{x:s+i/2,y:r+a/2};switch((t==null?void 0:t.position)??n){case W.Top:return{x:s+i/2,y:r};case W.Right:return{x:s+i,y:r+a/2};case W.Bottom:return{x:s+i/2,y:r+a};case W.Left:return{x:s,y:r+a/2}}}function wn(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function jt(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`:""}function ii(e,{id:t,defaultColor:n,defaultMarkerStart:o,defaultMarkerEnd:s}){const r=new Set;return e.reduce((i,a)=>([a.markerStart||o,a.markerEnd||s].forEach(l=>{if(l&&typeof l=="object"){const g=jt(l,t);r.has(g)||(i.push({id:g,color:l.color||n,...l}),r.add(g))}}),i),[]).sort((i,a)=>i.id.localeCompare(a.id))}const Xt={nodeOrigin:[0,0],nodeExtent:He,elevateNodesOnSelect:!0,defaults:{}},ai={...Xt,checkEquality:!0};function Wt(e,t){const n={...e};for(const o in t)t[o]!==void 0&&(n[o]=t[o]);return n}function ci(e,t,n){const o=Wt(Xt,n);for(const s of e.values())if(s.parentId)Gt(s,e,t,o);else{const r=Fe(s,o.nodeOrigin),i=_e(s.extent)?s.extent:o.nodeExtent,a=we(r,i,fe(s));s.internals.positionAbsolute=a}}function Lt(e,t,n,o){var l,g;const s=Wt(ai,o);let r=e.length>0;const i=new Map(t),a=s!=null&&s.elevateNodesOnSelect?1e3:0;t.clear(),n.clear();for(const u of e){let d=i.get(u.id);if(s.checkEquality&&u===(d==null?void 0:d.internals.userNode))t.set(u.id,d);else{const c=Fe(u,s.nodeOrigin),h=_e(u.extent)?u.extent:s.nodeExtent,y=we(c,h,fe(u));d={...s.defaults,...u,measured:{width:(l=u.measured)==null?void 0:l.width,height:(g=u.measured)==null?void 0:g.height},internals:{positionAbsolute:y,handleBounds:u.measured?d==null?void 0:d.internals.handleBounds:void 0,z:bo(u,a),userNode:u}},t.set(u.id,d)}(d.measured===void 0||d.measured.width===void 0||d.measured.height===void 0)&&!d.hidden&&(r=!1),u.parentId&&Gt(d,t,n,o)}return r}function li(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function Gt(e,t,n,o){const{elevateNodesOnSelect:s,nodeOrigin:r,nodeExtent:i}=Wt(Xt,o),a=e.parentId,l=t.get(a);if(!l){console.warn(`Parent node ${a} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}li(e,n);const g=s?1e3:0,{x:u,y:d,z:c}=ui(e,l,r,i,g),{positionAbsolute:h}=e.internals,y=u!==h.x||d!==h.y;(y||c!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:y?{x:u,y:d}:h,z:c}})}function bo(e,t){return(ce(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function ui(e,t,n,o,s){const{x:r,y:i}=t.internals.positionAbsolute,a=fe(e),l=Fe(e,n),g=_e(e.extent)?we(l,e.extent,a):l;let u=we({x:r+g.x,y:i+g.y},o,a);e.extent==="parent"&&(u=io(u,a,t));const d=bo(e,s),c=t.internals.z??0;return{x:u.x,y:u.y,z:c>=d?c+1:d}}function Kt(e,t,n,o=[0,0]){var i;const s=[],r=new Map;for(const a of e){const l=t.get(a.parentId);if(!l)continue;const g=((i=r.get(a.parentId))==null?void 0:i.expandedRect)??Ie(l),u=co(g,a.rect);r.set(a.parentId,{expandedRect:u,parent:l})}return r.size>0&&r.forEach(({expandedRect:a,parent:l},g)=>{var f;const u=l.internals.positionAbsolute,d=fe(l),c=l.origin??o,h=a.x<u.x?Math.round(Math.abs(u.x-a.x)):0,y=a.y<u.y?Math.round(Math.abs(u.y-a.y)):0,p=Math.max(d.width,Math.round(a.width)),b=Math.max(d.height,Math.round(a.height)),m=(p-d.width)*c[0],N=(b-d.height)*c[1];(h>0||y>0||m||N)&&(s.push({id:g,type:"position",position:{x:l.position.x-h+m,y:l.position.y-y+N}}),(f=n.get(g))==null||f.forEach(w=>{e.some(v=>v.id===w.id)||s.push({id:w.id,type:"position",position:{x:w.position.x+h,y:w.position.y+y}})})),(d.width<a.width||d.height<a.height||h||y)&&s.push({id:g,type:"dimensions",setAttributes:!0,dimensions:{width:p+(h?c[0]*h-m:0),height:b+(y?c[1]*y-N:0)}})}),s}function di(e,t,n,o,s,r){const i=o==null?void 0:o.querySelector(".xyflow__viewport");let a=!1;if(!i)return{changes:[],updatedInternals:a};const l=[],g=window.getComputedStyle(i),{m22:u}=new window.DOMMatrixReadOnly(g.transform),d=[];for(const c of e.values()){const h=t.get(c.id);if(!h)continue;if(h.hidden){t.set(h.id,{...h,internals:{...h.internals,handleBounds:void 0}}),a=!0;continue}const y=Yt(c.nodeElement),p=h.measured.width!==y.width||h.measured.height!==y.height;if(!!(y.width&&y.height&&(p||!h.internals.handleBounds||c.force))){const m=c.nodeElement.getBoundingClientRect(),N=_e(h.extent)?h.extent:r;let{positionAbsolute:f}=h.internals;h.parentId&&h.extent==="parent"?f=io(f,y,t.get(h.parentId)):N&&(f=we(f,N,y));const w={...h,measured:y,internals:{...h.internals,positionAbsolute:f,handleBounds:{source:hn("source",c.nodeElement,m,u,h.id),target:hn("target",c.nodeElement,m,u,h.id)}}};t.set(h.id,w),h.parentId&&Gt(w,t,n,{nodeOrigin:s}),a=!0,p&&(l.push({id:h.id,type:"dimensions",dimensions:y}),h.expandParent&&h.parentId&&d.push({id:h.id,parentId:h.parentId,rect:Ie(w,s)}))}}if(d.length>0){const c=Kt(d,t,n,s);l.push(...c)}return{changes:l,updatedInternals:a}}async function fi({delta:e,panZoom:t,transform:n,translateExtent:o,width:s,height:r}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const i=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[s,r]],o),a=!!i&&(i.x!==n[0]||i.y!==n[1]||i.k!==n[2]);return Promise.resolve(a)}function bn(e,t,n,o,s,r){let i=s;const a=o.get(i)||new Map;o.set(i,a.set(n,t)),i=`${s}-${e}`;const l=o.get(i)||new Map;if(o.set(i,l.set(n,t)),r){i=`${s}-${e}-${r}`;const g=o.get(i)||new Map;o.set(i,g.set(n,t))}}function vo(e,t,n){e.clear(),t.clear();for(const o of n){const{source:s,target:r,sourceHandle:i=null,targetHandle:a=null}=o,l={edgeId:o.id,source:s,target:r,sourceHandle:i,targetHandle:a},g=`${s}-${i}--${r}-${a}`,u=`${r}-${a}--${s}-${i}`;bn("source",l,u,e,s,i),bn("target",l,g,e,r,a),t.set(o.id,o)}}function Eo(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:Eo(n,t):!1}function vn(e,t,n){var s;let o=e;do{if((s=o==null?void 0:o.matches)!=null&&s.call(o,t))return!0;if(o===n)return!1;o=o==null?void 0:o.parentElement}while(o);return!1}function hi(e,t,n,o){const s=new Map;for(const[r,i]of e)if((i.selected||i.id===o)&&(!i.parentId||!Eo(i,e))&&(i.draggable||t&&typeof i.draggable>"u")){const a=e.get(r);a&&s.set(r,{id:r,position:a.position||{x:0,y:0},distance:{x:n.x-a.internals.positionAbsolute.x,y:n.y-a.internals.positionAbsolute.y},extent:a.extent,parentId:a.parentId,origin:a.origin,expandParent:a.expandParent,internals:{positionAbsolute:a.internals.positionAbsolute||{x:0,y:0}},measured:{width:a.measured.width??0,height:a.measured.height??0}})}return s}function kt({nodeId:e,dragItems:t,nodeLookup:n,dragging:o=!0}){var i,a,l;const s=[];for(const[g,u]of t){const d=(i=n.get(g))==null?void 0:i.internals.userNode;d&&s.push({...d,position:u.position,dragging:o})}if(!e)return[s[0],s];const r=(a=n.get(e))==null?void 0:a.internals.userNode;return[r?{...r,position:((l=t.get(e))==null?void 0:l.position)||r.position,dragging:o}:s[0],s]}function gi({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:o,onDragStop:s}){let r={x:null,y:null},i=0,a=new Map,l=!1,g={x:0,y:0},u=null,d=!1,c=null,h=!1,y=!1;function p({noDragClassName:m,handleSelector:N,domNode:f,isSelectable:w,nodeId:v,nodeClickDistance:I=0}){c=ie(f);function _({x:A,y:L},H){const{nodeLookup:x,nodeExtent:C,snapGrid:S,snapToGrid:M,nodeOrigin:z,onNodeDrag:k,onSelectionDrag:T,onError:D,updateNodePositions:R}=t();r={x:A,y:L};let O=!1,V={x:0,y:0,x2:0,y2:0};if(a.size>1&&C){const X=Oe(a);V=zt(X)}for(const[X,G]of a){if(!x.has(X))continue;let Y={x:A-G.distance.x,y:L-G.distance.y};M&&(Y=dt(Y,S));let F=[[C[0][0],C[0][1]],[C[1][0],C[1][1]]];if(a.size>1&&C&&!G.extent){const{positionAbsolute:Q}=G.internals,Z=Q.x-V.x+C[0][0],U=Q.x+G.measured.width-V.x2+C[1][0],q=Q.y-V.y+C[0][1],te=Q.y+G.measured.height-V.y2+C[1][1];F=[[Z,q],[U,te]]}const{position:K,positionAbsolute:ee}=ro({nodeId:X,nextPosition:Y,nodeLookup:x,nodeExtent:F,nodeOrigin:z,onError:D});O=O||G.position.x!==K.x||G.position.y!==K.y,G.position=K,G.internals.positionAbsolute=ee}if(y=y||O,!!O&&(R(a,!0),H&&(o||k||!v&&T))){const[X,G]=kt({nodeId:v,dragItems:a,nodeLookup:x});o==null||o(H,a,X,G),k==null||k(H,X,G),v||T==null||T(H,G)}}async function P(){if(!u)return;const{transform:A,panBy:L,autoPanSpeed:H,autoPanOnNodeDrag:x}=t();if(!x){l=!1,cancelAnimationFrame(i);return}const[C,S]=ao(g,u,H);(C!==0||S!==0)&&(r.x=(r.x??0)-C/A[2],r.y=(r.y??0)-S/A[2],await L({x:C,y:S})&&_(r,null)),i=requestAnimationFrame(P)}function j(A){var O;const{nodeLookup:L,multiSelectionActive:H,nodesDraggable:x,transform:C,snapGrid:S,snapToGrid:M,selectNodesOnDrag:z,onNodeDragStart:k,onSelectionDragStart:T,unselectNodesAndEdges:D}=t();d=!0,(!z||!w)&&!H&&v&&((O=L.get(v))!=null&&O.selected||D()),w&&z&&v&&(e==null||e(v));const R=je(A.sourceEvent,{transform:C,snapGrid:S,snapToGrid:M,containerBounds:u});if(r=R,a=hi(L,x,R,v),a.size>0&&(n||k||!v&&T)){const[V,X]=kt({nodeId:v,dragItems:a,nodeLookup:L});n==null||n(A.sourceEvent,a,V,X),k==null||k(A.sourceEvent,V,X),v||T==null||T(A.sourceEvent,X)}}const B=Qn().clickDistance(I).on("start",A=>{const{domNode:L,nodeDragThreshold:H,transform:x,snapGrid:C,snapToGrid:S}=t();u=(L==null?void 0:L.getBoundingClientRect())||null,h=!1,y=!1,H===0&&j(A),r=je(A.sourceEvent,{transform:x,snapGrid:C,snapToGrid:S,containerBounds:u}),g=le(A.sourceEvent,u)}).on("drag",A=>{const{autoPanOnNodeDrag:L,transform:H,snapGrid:x,snapToGrid:C,nodeDragThreshold:S,nodeLookup:M}=t(),z=je(A.sourceEvent,{transform:H,snapGrid:x,snapToGrid:C,containerBounds:u});if((A.sourceEvent.type==="touchmove"&&A.sourceEvent.touches.length>1||v&&!M.has(v))&&(h=!0),!h){if(!l&&L&&d&&(l=!0,P()),!d){const k=z.xSnapped-(r.x??0),T=z.ySnapped-(r.y??0);Math.sqrt(k*k+T*T)>S&&j(A)}(r.x!==z.xSnapped||r.y!==z.ySnapped)&&a&&d&&(g=le(A.sourceEvent,u),_(z,A.sourceEvent))}}).on("end",A=>{if(!(!d||h)&&(l=!1,d=!1,cancelAnimationFrame(i),a.size>0)){const{nodeLookup:L,updateNodePositions:H,onNodeDragStop:x,onSelectionDragStop:C}=t();if(y&&(H(a,!1),y=!1),s||x||!v&&C){const[S,M]=kt({nodeId:v,dragItems:a,nodeLookup:L,dragging:!1});s==null||s(A.sourceEvent,a,S,M),x==null||x(A.sourceEvent,S,M),v||C==null||C(A.sourceEvent,M)}}}).filter(A=>{const L=A.target;return!A.button&&(!m||!vn(L,`.${m}`,f))&&(!N||vn(L,N,f))});c.call(B)}function b(){c==null||c.on(".drag",null)}return{update:p,destroy:b}}function pi(e,t,n){const o=[],s={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const r of t.values())Be(s,Ie(r))>0&&o.push(r);return o}const mi=250;function yi(e,t,n,o){var a,l;let s=[],r=1/0;const i=pi(e,n,t+mi);for(const g of i){const u=[...((a=g.internals.handleBounds)==null?void 0:a.source)??[],...((l=g.internals.handleBounds)==null?void 0:l.target)??[]];for(const d of u){if(o.nodeId===d.nodeId&&o.type===d.type&&o.id===d.id)continue;const{x:c,y:h}=Re(g,d,d.position,!0),y=Math.sqrt(Math.pow(c-e.x,2)+Math.pow(h-e.y,2));y>t||(y<r?(s=[{...d,x:c,y:h}],r=y):y===r&&s.push({...d,x:c,y:h}))}}if(!s.length)return null;if(s.length>1){const g=o.type==="source"?"target":"source";return s.find(u=>u.type===g)??s[0]}return s[0]}function So(e,t,n,o,s,r=!1){var g,u,d;const i=o.get(e);if(!i)return null;const a=s==="strict"?(g=i.internals.handleBounds)==null?void 0:g[t]:[...((u=i.internals.handleBounds)==null?void 0:u.source)??[],...((d=i.internals.handleBounds)==null?void 0:d.target)??[]],l=(n?a==null?void 0:a.find(c=>c.id===n):a==null?void 0:a[0])??null;return l&&r?{...l,...Re(i,l,l.position,!0)}:l}function No(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function xi(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const Co=()=>!0;function wi(e,{connectionMode:t,connectionRadius:n,handleId:o,nodeId:s,edgeUpdaterType:r,isTarget:i,domNode:a,nodeLookup:l,lib:g,autoPanOnConnect:u,flowId:d,panBy:c,cancelConnection:h,onConnectStart:y,onConnect:p,onConnectEnd:b,isValidConnection:m=Co,onReconnectEnd:N,updateConnection:f,getTransform:w,getFromHandle:v,autoPanSpeed:I,dragThreshold:_=1}){const P=fo(e.target);let j=0,B;const{x:A,y:L}=le(e),H=P==null?void 0:P.elementFromPoint(A,L),x=No(r,H),C=a==null?void 0:a.getBoundingClientRect();let S=!1;if(!C||!x)return;const M=So(s,x,o,l,t);if(!M)return;let z=le(e,C),k=!1,T=null,D=!1,R=null;function O(){if(!u||!C)return;const[Q,Z]=ao(z,C,I);c({x:Q,y:Z}),j=requestAnimationFrame(O)}const V={...M,nodeId:s,type:x,position:M.position},X=l.get(s);let Y={inProgress:!0,isValid:null,from:Re(X,V,W.Left,!0),fromHandle:V,fromPosition:V.position,fromNode:X,to:z,toHandle:null,toPosition:ln[V.position],toNode:null};function F(){S=!0,f(Y),y==null||y(e,{nodeId:s,handleId:o,handleType:x})}_===0&&F();function K(Q){if(!S){const{x:te,y:se}=le(Q),de=te-A,be=se-L;if(!(de*de+be*be>_*_))return;F()}if(!v()||!V){ee(Q);return}const Z=w();z=le(Q,C),B=yi(Ye(z,Z,!1,[1,1]),n,l,V),k||(O(),k=!0);const U=Mo(Q,{handle:B,connectionMode:t,fromNodeId:s,fromHandleId:o,fromType:i?"target":"source",isValidConnection:m,doc:P,lib:g,flowId:d,nodeLookup:l});R=U.handleDomNode,T=U.connection,D=xi(!!B,U.isValid);const q={...Y,isValid:D,to:U.toHandle&&D?rt({x:U.toHandle.x,y:U.toHandle.y},Z):z,toHandle:U.toHandle,toPosition:D&&U.toHandle?U.toHandle.position:ln[V.position],toNode:U.toHandle?l.get(U.toHandle.nodeId):null};D&&B&&Y.toHandle&&q.toHandle&&Y.toHandle.type===q.toHandle.type&&Y.toHandle.nodeId===q.toHandle.nodeId&&Y.toHandle.id===q.toHandle.id&&Y.to.x===q.to.x&&Y.to.y===q.to.y||(f(q),Y=q)}function ee(Q){if(S){(B||R)&&T&&D&&(p==null||p(T));const{inProgress:Z,...U}=Y,q={...U,toPosition:Y.toHandle?Y.toPosition:null};b==null||b(Q,q),r&&(N==null||N(Q,q))}h(),cancelAnimationFrame(j),k=!1,D=!1,T=null,R=null,P.removeEventListener("mousemove",K),P.removeEventListener("mouseup",ee),P.removeEventListener("touchmove",K),P.removeEventListener("touchend",ee)}P.addEventListener("mousemove",K),P.addEventListener("mouseup",ee),P.addEventListener("touchmove",K),P.addEventListener("touchend",ee)}function Mo(e,{handle:t,connectionMode:n,fromNodeId:o,fromHandleId:s,fromType:r,doc:i,lib:a,flowId:l,isValidConnection:g=Co,nodeLookup:u}){const d=r==="target",c=t?i.querySelector(`.${a}-flow__handle[data-id="${l}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:h,y}=le(e),p=i.elementFromPoint(h,y),b=p!=null&&p.classList.contains(`${a}-flow__handle`)?p:c,m={handleDomNode:b,isValid:!1,connection:null,toHandle:null};if(b){const N=No(void 0,b),f=b.getAttribute("data-nodeid"),w=b.getAttribute("data-handleid"),v=b.classList.contains("connectable"),I=b.classList.contains("connectableend");if(!f||!N)return m;const _={source:d?f:o,sourceHandle:d?w:s,target:d?o:f,targetHandle:d?s:w};m.connection=_;const j=v&&I&&(n===Me.Strict?d&&N==="source"||!d&&N==="target":f!==o||w!==s);m.isValid=j&&g(_),m.toHandle=So(f,N,w,u,n,!0)}return m}const Ht={onPointerDown:wi,isValid:Mo};function bi({domNode:e,panZoom:t,getTransform:n,getViewScale:o}){const s=ie(e);function r({translateExtent:a,width:l,height:g,zoomStep:u=10,pannable:d=!0,zoomable:c=!0,inversePan:h=!1}){const y=f=>{const w=n();if(f.sourceEvent.type!=="wheel"||!t)return;const v=-f.sourceEvent.deltaY*(f.sourceEvent.deltaMode===1?.05:f.sourceEvent.deltaMode?1:.002)*u,I=w[2]*Math.pow(2,v);t.scaleTo(I)};let p=[0,0];const b=f=>{(f.sourceEvent.type==="mousedown"||f.sourceEvent.type==="touchstart")&&(p=[f.sourceEvent.clientX??f.sourceEvent.touches[0].clientX,f.sourceEvent.clientY??f.sourceEvent.touches[0].clientY])},m=f=>{const w=n();if(f.sourceEvent.type!=="mousemove"&&f.sourceEvent.type!=="touchmove"||!t)return;const v=[f.sourceEvent.clientX??f.sourceEvent.touches[0].clientX,f.sourceEvent.clientY??f.sourceEvent.touches[0].clientY],I=[v[0]-p[0],v[1]-p[1]];p=v;const _=o()*Math.max(w[2],Math.log(w[2]))*(h?-1:1),P={x:w[0]-I[0]*_,y:w[1]-I[1]*_},j=[[0,0],[l,g]];t.setViewportConstrained({x:P.x,y:P.y,zoom:w[2]},j,a)},N=Jn().on("start",b).on("zoom",d?m:null).on("zoom.wheel",c?y:null);s.call(N,{})}function i(){s.on("zoom",null)}return{update:r,destroy:i,pointer:ae}}const vi=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,ft=e=>({x:e.x,y:e.y,zoom:e.k}),It=({x:e,y:t,zoom:n})=>Rt.translate(e,t).scale(n),Se=(e,t)=>e.target.closest(`.${t}`),ko=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),Ei=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,_t=(e,t=0,n=Ei,o=()=>{})=>{const s=typeof t=="number"&&t>0;return s||o(),s?e.transition().duration(t).ease(n).on("end",o):e},Io=e=>{const t=e.ctrlKey&&it()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function Si({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:o,panOnScrollMode:s,panOnScrollSpeed:r,zoomOnPinch:i,onPanZoomStart:a,onPanZoom:l,onPanZoomEnd:g}){return u=>{if(Se(u,t))return!1;u.preventDefault(),u.stopImmediatePropagation();const d=n.property("__zoom").k||1;if(u.ctrlKey&&i){const b=ae(u),m=Io(u),N=d*Math.pow(2,m);o.scaleTo(n,N,b,u);return}const c=u.deltaMode===1?20:1;let h=s===xe.Vertical?0:u.deltaX*c,y=s===xe.Horizontal?0:u.deltaY*c;!it()&&u.shiftKey&&s!==xe.Vertical&&(h=u.deltaY*c,y=0),o.translateBy(n,-(h/d)*r,-(y/d)*r,{internal:!0});const p=ft(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,a==null||a(u,p)),e.isPanScrolling&&(l==null||l(u,p),e.panScrollTimeout=setTimeout(()=>{g==null||g(u,p),e.isPanScrolling=!1},150))}}function Ni({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(o,s){const r=o.type==="wheel",i=!t&&r&&!o.ctrlKey,a=Se(o,e);if(o.ctrlKey&&r&&a&&o.preventDefault(),i||a)return null;o.preventDefault(),n.call(this,o,s)}}function Ci({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return o=>{var r,i,a;if((r=o.sourceEvent)!=null&&r.internal)return;const s=ft(o.transform);e.mouseButton=((i=o.sourceEvent)==null?void 0:i.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=s,((a=o.sourceEvent)==null?void 0:a.type)==="mousedown"&&t(!0),n&&(n==null||n(o.sourceEvent,s))}}function Mi({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:o,onPanZoom:s}){return r=>{var i,a;e.usedRightMouseButton=!!(n&&ko(t,e.mouseButton??0)),(i=r.sourceEvent)!=null&&i.sync||o([r.transform.x,r.transform.y,r.transform.k]),s&&!((a=r.sourceEvent)!=null&&a.internal)&&(s==null||s(r.sourceEvent,ft(r.transform)))}}function ki({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:o,onPanZoomEnd:s,onPaneContextMenu:r}){return i=>{var a;if(!((a=i.sourceEvent)!=null&&a.internal)&&(e.isZoomingOrPanning=!1,r&&ko(t,e.mouseButton??0)&&!e.usedRightMouseButton&&i.sourceEvent&&r(i.sourceEvent),e.usedRightMouseButton=!1,o(!1),s&&vi(e.prevViewport,i.transform))){const l=ft(i.transform);e.prevViewport=l,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{s==null||s(i.sourceEvent,l)},n?150:0)}}}function Ii({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:o,panOnScroll:s,zoomOnDoubleClick:r,userSelectionActive:i,noWheelClassName:a,noPanClassName:l,lib:g}){return u=>{var y;const d=e||t,c=n&&u.ctrlKey;if(u.button===1&&u.type==="mousedown"&&(Se(u,`${g}-flow__node`)||Se(u,`${g}-flow__edge`)))return!0;if(!o&&!d&&!s&&!r&&!n||i||Se(u,a)&&u.type==="wheel"||Se(u,l)&&(u.type!=="wheel"||s&&u.type==="wheel"&&!e)||!n&&u.ctrlKey&&u.type==="wheel")return!1;if(!n&&u.type==="touchstart"&&((y=u.touches)==null?void 0:y.length)>1)return u.preventDefault(),!1;if(!d&&!s&&!c&&u.type==="wheel"||!o&&(u.type==="mousedown"||u.type==="touchstart")||Array.isArray(o)&&!o.includes(u.button)&&u.type==="mousedown")return!1;const h=Array.isArray(o)&&o.includes(u.button)||!u.button||u.button<=1;return(!u.ctrlKey||u.type==="wheel")&&h}}function _i({domNode:e,minZoom:t,maxZoom:n,paneClickDistance:o,translateExtent:s,viewport:r,onPanZoom:i,onPanZoomStart:a,onPanZoomEnd:l,onDraggingChange:g}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},d=e.getBoundingClientRect(),c=Jn().clickDistance(!ce(o)||o<0?0:o).scaleExtent([t,n]).translateExtent(s),h=ie(e).call(c);f({x:r.x,y:r.y,zoom:ke(r.zoom,t,n)},[[0,0],[d.width,d.height]],s);const y=h.on("wheel.zoom"),p=h.on("dblclick.zoom");c.wheelDelta(Io);function b(L,H){return h?new Promise(x=>{c==null||c.interpolate((H==null?void 0:H.interpolate)==="linear"?Nt:nt).transform(_t(h,H==null?void 0:H.duration,H==null?void 0:H.ease,()=>x(!0)),L)}):Promise.resolve(!1)}function m({noWheelClassName:L,noPanClassName:H,onPaneContextMenu:x,userSelectionActive:C,panOnScroll:S,panOnDrag:M,panOnScrollMode:z,panOnScrollSpeed:k,preventScrolling:T,zoomOnPinch:D,zoomOnScroll:R,zoomOnDoubleClick:O,zoomActivationKeyPressed:V,lib:X,onTransformChange:G}){C&&!u.isZoomingOrPanning&&N();const F=S&&!V&&!C?Si({zoomPanValues:u,noWheelClassName:L,d3Selection:h,d3Zoom:c,panOnScrollMode:z,panOnScrollSpeed:k,zoomOnPinch:D,onPanZoomStart:a,onPanZoom:i,onPanZoomEnd:l}):Ni({noWheelClassName:L,preventScrolling:T,d3ZoomHandler:y});if(h.on("wheel.zoom",F,{passive:!1}),!C){const ee=Ci({zoomPanValues:u,onDraggingChange:g,onPanZoomStart:a});c.on("start",ee);const Q=Mi({zoomPanValues:u,panOnDrag:M,onPaneContextMenu:!!x,onPanZoom:i,onTransformChange:G});c.on("zoom",Q);const Z=ki({zoomPanValues:u,panOnDrag:M,panOnScroll:S,onPaneContextMenu:x,onPanZoomEnd:l,onDraggingChange:g});c.on("end",Z)}const K=Ii({zoomActivationKeyPressed:V,panOnDrag:M,zoomOnScroll:R,panOnScroll:S,zoomOnDoubleClick:O,zoomOnPinch:D,userSelectionActive:C,noPanClassName:H,noWheelClassName:L,lib:X});c.filter(K),O?h.on("dblclick.zoom",p):h.on("dblclick.zoom",null)}function N(){c.on("zoom",null)}async function f(L,H,x){const C=It(L),S=c==null?void 0:c.constrain()(C,H,x);return S&&await b(S),new Promise(M=>M(S))}async function w(L,H){const x=It(L);return await b(x,H),new Promise(C=>C(x))}function v(L){if(h){const H=It(L),x=h.property("__zoom");(x.k!==L.zoom||x.x!==L.x||x.y!==L.y)&&(c==null||c.transform(h,H,null,{sync:!0}))}}function I(){const L=h?yr(h.node()):{x:0,y:0,k:1};return{x:L.x,y:L.y,zoom:L.k}}function _(L,H){return h?new Promise(x=>{c==null||c.interpolate((H==null?void 0:H.interpolate)==="linear"?Nt:nt).scaleTo(_t(h,H==null?void 0:H.duration,H==null?void 0:H.ease,()=>x(!0)),L)}):Promise.resolve(!1)}function P(L,H){return h?new Promise(x=>{c==null||c.interpolate((H==null?void 0:H.interpolate)==="linear"?Nt:nt).scaleBy(_t(h,H==null?void 0:H.duration,H==null?void 0:H.ease,()=>x(!0)),L)}):Promise.resolve(!1)}function j(L){c==null||c.scaleExtent(L)}function B(L){c==null||c.translateExtent(L)}function A(L){const H=!ce(L)||L<0?0:L;c==null||c.clickDistance(H)}return{update:m,destroy:N,setViewport:w,setViewportConstrained:f,getViewport:I,scaleTo:_,scaleBy:P,setScaleExtent:j,setTranslateExtent:B,syncViewport:v,setClickDistance:A}}var Pe;(function(e){e.Line="line",e.Handle="handle"})(Pe||(Pe={}));function Pi({width:e,prevWidth:t,height:n,prevHeight:o,affectsX:s,affectsY:r}){const i=e-t,a=n-o,l=[i>0?1:i<0?-1:0,a>0?1:a<0?-1:0];return i&&s&&(l[0]=l[0]*-1),a&&r&&(l[1]=l[1]*-1),l}function $i(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),o=e.includes("left"),s=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:o,affectsY:s}}function he(e,t){return Math.max(0,t-e)}function ge(e,t){return Math.max(0,e-t)}function Je(e,t,n){return Math.max(0,t-e,e-n)}function En(e,t){return e?!t:t}function Ai(e,t,n,o,s,r,i,a){let{affectsX:l,affectsY:g}=t;const{isHorizontal:u,isVertical:d}=t,c=u&&d,{xSnapped:h,ySnapped:y}=n,{minWidth:p,maxWidth:b,minHeight:m,maxHeight:N}=o,{x:f,y:w,width:v,height:I,aspectRatio:_}=e;let P=Math.floor(u?h-e.pointerX:0),j=Math.floor(d?y-e.pointerY:0);const B=v+(l?-P:P),A=I+(g?-j:j),L=-r[0]*v,H=-r[1]*I;let x=Je(B,p,b),C=Je(A,m,N);if(i){let z=0,k=0;l&&P<0?z=he(f+P+L,i[0][0]):!l&&P>0&&(z=ge(f+B+L,i[1][0])),g&&j<0?k=he(w+j+H,i[0][1]):!g&&j>0&&(k=ge(w+A+H,i[1][1])),x=Math.max(x,z),C=Math.max(C,k)}if(a){let z=0,k=0;l&&P>0?z=ge(f+P,a[0][0]):!l&&P<0&&(z=he(f+B,a[1][0])),g&&j>0?k=ge(w+j,a[0][1]):!g&&j<0&&(k=he(w+A,a[1][1])),x=Math.max(x,z),C=Math.max(C,k)}if(s){if(u){const z=Je(B/_,m,N)*_;if(x=Math.max(x,z),i){let k=0;!l&&!g||l&&!g&&c?k=ge(w+H+B/_,i[1][1])*_:k=he(w+H+(l?P:-P)/_,i[0][1])*_,x=Math.max(x,k)}if(a){let k=0;!l&&!g||l&&!g&&c?k=he(w+B/_,a[1][1])*_:k=ge(w+(l?P:-P)/_,a[0][1])*_,x=Math.max(x,k)}}if(d){const z=Je(A*_,p,b)/_;if(C=Math.max(C,z),i){let k=0;!l&&!g||g&&!l&&c?k=ge(f+A*_+L,i[1][0])/_:k=he(f+(g?j:-j)*_+L,i[0][0])/_,C=Math.max(C,k)}if(a){let k=0;!l&&!g||g&&!l&&c?k=he(f+A*_,a[1][0])/_:k=ge(f+(g?j:-j)*_,a[0][0])/_,C=Math.max(C,k)}}}j=j+(j<0?C:-C),P=P+(P<0?x:-x),s&&(c?B>A*_?j=(En(l,g)?-P:P)/_:P=(En(l,g)?-j:j)*_:u?(j=P/_,g=l):(P=j*_,l=g));const S=l?f+P:f,M=g?w+j:w;return{width:v+(l?-P:P),height:I+(g?-j:j),x:r[0]*P*(l?-1:1)+S,y:r[1]*j*(g?-1:1)+M}}const _o={width:0,height:0,x:0,y:0},zi={..._o,pointerX:0,pointerY:0,aspectRatio:1};function Ti(e){return[[0,0],[e.measured.width,e.measured.height]]}function ji(e,t,n){const o=t.position.x+e.position.x,s=t.position.y+e.position.y,r=e.measured.width??0,i=e.measured.height??0,a=n[0]*r,l=n[1]*i;return[[o-a,s-l],[o+r-a,s+i-l]]}function Li({domNode:e,nodeId:t,getStoreItems:n,onChange:o,onEnd:s}){const r=ie(e);function i({controlPosition:l,boundaries:g,keepAspectRatio:u,resizeDirection:d,onResizeStart:c,onResize:h,onResizeEnd:y,shouldResize:p}){let b={..._o},m={...zi};const N=$i(l);let f,w=null,v=[],I,_,P;const j=Qn().on("start",B=>{const{nodeLookup:A,transform:L,snapGrid:H,snapToGrid:x,nodeOrigin:C,paneDomNode:S}=n();if(f=A.get(t),!f)return;w=(S==null?void 0:S.getBoundingClientRect())??null;const{xSnapped:M,ySnapped:z}=je(B.sourceEvent,{transform:L,snapGrid:H,snapToGrid:x,containerBounds:w});b={width:f.measured.width??0,height:f.measured.height??0,x:f.position.x??0,y:f.position.y??0},m={...b,pointerX:M,pointerY:z,aspectRatio:b.width/b.height},I=void 0,f.parentId&&(f.extent==="parent"||f.expandParent)&&(I=A.get(f.parentId),_=I&&f.extent==="parent"?Ti(I):void 0),v=[],P=void 0;for(const[k,T]of A)if(T.parentId===t&&(v.push({id:k,position:{...T.position},extent:T.extent}),T.extent==="parent"||T.expandParent)){const D=ji(T,f,T.origin??C);P?P=[[Math.min(D[0][0],P[0][0]),Math.min(D[0][1],P[0][1])],[Math.max(D[1][0],P[1][0]),Math.max(D[1][1],P[1][1])]]:P=D}c==null||c(B,{...b})}).on("drag",B=>{const{transform:A,snapGrid:L,snapToGrid:H,nodeOrigin:x}=n(),C=je(B.sourceEvent,{transform:A,snapGrid:L,snapToGrid:H,containerBounds:w}),S=[];if(!f)return;const{x:M,y:z,width:k,height:T}=b,D={},R=f.origin??x,{width:O,height:V,x:X,y:G}=Ai(m,N,C,g,u,R,_,P),Y=O!==k,F=V!==T,K=X!==M&&Y,ee=G!==z&&F;if(!K&&!ee&&!Y&&!F)return;if((K||ee||R[0]===1||R[1]===1)&&(D.x=K?X:b.x,D.y=ee?G:b.y,b.x=D.x,b.y=D.y,v.length>0)){const q=X-M,te=G-z;for(const se of v)se.position={x:se.position.x-q+R[0]*(O-k),y:se.position.y-te+R[1]*(V-T)},S.push(se)}if((Y||F)&&(D.width=Y&&(!d||d==="horizontal")?O:b.width,D.height=F&&(!d||d==="vertical")?V:b.height,b.width=D.width,b.height=D.height),I&&f.expandParent){const q=R[0]*(D.width??0);D.x&&D.x<q&&(b.x=q,m.x=m.x-(D.x-q));const te=R[1]*(D.height??0);D.y&&D.y<te&&(b.y=te,m.y=m.y-(D.y-te))}const Q=Pi({width:b.width,prevWidth:k,height:b.height,prevHeight:T,affectsX:N.affectsX,affectsY:N.affectsY}),Z={...b,direction:Q};(p==null?void 0:p(B,Z))!==!1&&(h==null||h(B,Z),o(D,S))}).on("end",B=>{y==null||y(B,{...b}),s==null||s({...b})});r.call(j)}function a(){r.on(".drag",null)}return{update:i,destroy:a}}const Hi={},Sn=e=>{let t;const n=new Set,o=(u,d)=>{const c=typeof u=="function"?u(t):u;if(!Object.is(c,t)){const h=t;t=d??(typeof c!="object"||c===null)?c:Object.assign({},t,c),n.forEach(y=>y(t,h))}},s=()=>t,l={setState:o,getState:s,getInitialState:()=>g,subscribe:u=>(n.add(u),()=>n.delete(u)),destroy:()=>{(Hi?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},g=t=e(o,s,l);return l},Di=e=>e?Sn(e):Sn,{useDebugValue:Bi}=pr,{useSyncExternalStoreWithSelector:Ri}=gr,Vi=e=>e;function Po(e,t=Vi,n){const o=Ri(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Bi(o),o}const Nn=(e,t)=>{const n=Di(e),o=(s,r=t)=>Po(n,s,r);return Object.assign(o,n),o},Fi=(e,t)=>e?Nn(e,t):Nn;function oe(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[o,s]of e)if(!Object.is(s,t.get(o)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const o of e)if(!t.has(o))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const o of n)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}const ht=$.createContext(null),Oi=ht.Provider,$o=ue.error001();function J(e,t){const n=$.useContext(ht);if(n===null)throw new Error($o);return Po(n,e,t)}function ne(){const e=$.useContext(ht);if(e===null)throw new Error($o);return $.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const Cn={display:"none"},Yi={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Ao="react-flow__node-desc",zo="react-flow__edge-desc",Xi="react-flow__aria-live",Wi=e=>e.ariaLiveMessage,Gi=e=>e.ariaLabelConfig;function Ki({rfId:e}){const t=J(Wi);return E.jsx("div",{id:`${Xi}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:Yi,children:t})}function Zi({rfId:e,disableKeyboardA11y:t}){const n=J(Gi);return E.jsxs(E.Fragment,{children:[E.jsx("div",{id:`${Ao}-${e}`,style:Cn,children:t?n["node.a11yDescription.default"]:n["node.a11yDescription.keyboardDisabled"]}),E.jsx("div",{id:`${zo}-${e}`,style:Cn,children:n["edge.a11yDescription.default"]}),!t&&E.jsx(Ki,{rfId:e})]})}const gt=$.forwardRef(({position:e="top-left",children:t,className:n,style:o,...s},r)=>{const i=`${e}`.split("-");return E.jsx("div",{className:re(["react-flow__panel",n,...i]),style:o,ref:r,...s,children:t})});gt.displayName="Panel";function qi({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:E.jsx(gt,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:E.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const Ui=e=>{const t=[],n=[];for(const[,o]of e.nodeLookup)o.selected&&t.push(o.internals.userNode);for(const[,o]of e.edgeLookup)o.selected&&n.push(o);return{selectedNodes:t,selectedEdges:n}},et=e=>e.id;function Qi(e,t){return oe(e.selectedNodes.map(et),t.selectedNodes.map(et))&&oe(e.selectedEdges.map(et),t.selectedEdges.map(et))}function Ji({onSelectionChange:e}){const t=ne(),{selectedNodes:n,selectedEdges:o}=J(Ui,Qi);return $.useEffect(()=>{const s={nodes:n,edges:o};e==null||e(s),t.getState().onSelectionChangeHandlers.forEach(r=>r(s))},[n,o,e]),null}const ea=e=>!!e.onSelectionChangeHandlers;function ta({onSelectionChange:e}){const t=J(ea);return e||t?E.jsx(Ji,{onSelectionChange:e}):null}const To=[0,0],na={x:0,y:0,zoom:1},oa=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance","ariaLabelConfig"],Mn=[...oa,"rfId"],sa=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),kn={translateExtent:He,nodeOrigin:To,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function ra(e){const{setNodes:t,setEdges:n,setMinZoom:o,setMaxZoom:s,setTranslateExtent:r,setNodeExtent:i,reset:a,setDefaultNodesAndEdges:l,setPaneClickDistance:g}=J(sa,oe),u=ne();$.useEffect(()=>(l(e.defaultNodes,e.defaultEdges),()=>{d.current=kn,a()}),[]);const d=$.useRef(kn);return $.useEffect(()=>{for(const c of Mn){const h=e[c],y=d.current[c];h!==y&&(typeof e[c]>"u"||(c==="nodes"?t(h):c==="edges"?n(h):c==="minZoom"?o(h):c==="maxZoom"?s(h):c==="translateExtent"?r(h):c==="nodeExtent"?i(h):c==="paneClickDistance"?g(h):c==="ariaLabelConfig"?u.setState({ariaLabelConfig:qr(h)}):c==="fitView"?u.setState({fitViewQueued:h}):c==="fitViewOptions"?u.setState({fitViewOptions:h}):u.setState({[c]:h})))}d.current=e},Mn.map(c=>e[c])),null}function In(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function ia(e){var o;const[t,n]=$.useState(e==="system"?null:e);return $.useEffect(()=>{if(e!=="system"){n(e);return}const s=In(),r=()=>n(s!=null&&s.matches?"dark":"light");return r(),s==null||s.addEventListener("change",r),()=>{s==null||s.removeEventListener("change",r)}},[e]),t!==null?t:(o=In())!=null&&o.matches?"dark":"light"}const _n=typeof document<"u"?document:null;function Ve(e=null,t={target:_n,actInsideInputWithModifier:!0}){const[n,o]=$.useState(!1),s=$.useRef(!1),r=$.useRef(new Set([])),[i,a]=$.useMemo(()=>{if(e!==null){const g=(Array.isArray(e)?e:[e]).filter(d=>typeof d=="string").map(d=>d.replace("+",`
`).replace(`

`,`
+`).split(`
`)),u=g.reduce((d,c)=>d.concat(...c),[]);return[g,u]}return[[],[]]},[e]);return $.useEffect(()=>{const l=(t==null?void 0:t.target)??_n,g=(t==null?void 0:t.actInsideInputWithModifier)??!0;if(e!==null){const u=h=>{var b,m;if(s.current=h.ctrlKey||h.metaKey||h.shiftKey||h.altKey,(!s.current||s.current&&!g)&&ho(h))return!1;const p=$n(h.code,a);if(r.current.add(h[p]),Pn(i,r.current,!1)){const N=((m=(b=h.composedPath)==null?void 0:b.call(h))==null?void 0:m[0])||h.target,f=(N==null?void 0:N.nodeName)==="BUTTON"||(N==null?void 0:N.nodeName)==="A";t.preventDefault!==!1&&(s.current||!f)&&h.preventDefault(),o(!0)}},d=h=>{const y=$n(h.code,a);Pn(i,r.current,!0)?(o(!1),r.current.clear()):r.current.delete(h[y]),h.key==="Meta"&&r.current.clear(),s.current=!1},c=()=>{r.current.clear(),o(!1)};return l==null||l.addEventListener("keydown",u),l==null||l.addEventListener("keyup",d),window.addEventListener("blur",c),window.addEventListener("contextmenu",c),()=>{l==null||l.removeEventListener("keydown",u),l==null||l.removeEventListener("keyup",d),window.removeEventListener("blur",c),window.removeEventListener("contextmenu",c)}}},[e,o]),n}function Pn(e,t,n){return e.filter(o=>n||o.length===t.size).some(o=>o.every(s=>t.has(s)))}function $n(e,t){return t.includes(e)?"code":"key"}const aa=()=>{const e=ne();return $.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:o}=e.getState();return o?o.scaleTo(t,{duration:n==null?void 0:n.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[o,s,r],panZoom:i}=e.getState();return i?(await i.setViewport({x:t.x??o,y:t.y??s,zoom:t.zoom??r},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,o]=e.getState().transform;return{x:t,y:n,zoom:o}},setCenter:async(t,n,o)=>e.getState().setCenter(t,n,o),fitBounds:async(t,n)=>{const{width:o,height:s,minZoom:r,maxZoom:i,panZoom:a}=e.getState(),l=Ot(t,o,s,r,i,(n==null?void 0:n.padding)??.1);return a?(await a.setViewport(l,{duration:n==null?void 0:n.duration,ease:n==null?void 0:n.ease,interpolate:n==null?void 0:n.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{const{transform:o,snapGrid:s,snapToGrid:r,domNode:i}=e.getState();if(!i)return t;const{x:a,y:l}=i.getBoundingClientRect(),g={x:t.x-a,y:t.y-l},u=n.snapGrid??s,d=n.snapToGrid??r;return Ye(g,o,d,u)},flowToScreenPosition:t=>{const{transform:n,domNode:o}=e.getState();if(!o)return t;const{x:s,y:r}=o.getBoundingClientRect(),i=rt(t,n);return{x:i.x+s,y:i.y+r}}}),[])};function jo(e,t){const n=[],o=new Map,s=[];for(const r of e)if(r.type==="add"){s.push(r);continue}else if(r.type==="remove"||r.type==="replace")o.set(r.id,[r]);else{const i=o.get(r.id);i?i.push(r):o.set(r.id,[r])}for(const r of t){const i=o.get(r.id);if(!i){n.push(r);continue}if(i[0].type==="remove")continue;if(i[0].type==="replace"){n.push({...i[0].item});continue}const a={...r};for(const l of i)ca(l,a);n.push(a)}return s.length&&s.forEach(r=>{r.index!==void 0?n.splice(r.index,0,{...r.item}):n.push({...r.item})}),n}function ca(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured??(t.measured={}),t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&((e.setAttributes===!0||e.setAttributes==="width")&&(t.width=e.dimensions.width),(e.setAttributes===!0||e.setAttributes==="height")&&(t.height=e.dimensions.height))),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function Lo(e,t){return jo(e,t)}function Ho(e,t){return jo(e,t)}function ye(e,t){return{id:e,type:"select",selected:t}}function Ne(e,t=new Set,n=!1){const o=[];for(const[s,r]of e){const i=t.has(s);!(r.selected===void 0&&!i)&&r.selected!==i&&(n&&(r.selected=i),o.push(ye(r.id,i)))}return o}function An({items:e=[],lookup:t}){var s;const n=[],o=new Map(e.map(r=>[r.id,r]));for(const[r,i]of e.entries()){const a=t.get(i.id),l=((s=a==null?void 0:a.internals)==null?void 0:s.userNode)??a;l!==void 0&&l!==i&&n.push({id:i.id,item:i,type:"replace"}),l===void 0&&n.push({item:i,type:"add",index:r})}for(const[r]of t)o.get(r)===void 0&&n.push({id:r,type:"remove"});return n}function zn(e){return{id:e.id,type:"remove"}}const Tn=e=>Rr(e),la=e=>so(e);function Do(e){return $.forwardRef(e)}const ua=typeof window<"u"?$.useLayoutEffect:$.useEffect;function jn(e){const[t,n]=$.useState(BigInt(0)),[o]=$.useState(()=>da(()=>n(s=>s+BigInt(1))));return ua(()=>{const s=o.get();s.length&&(e(s),o.reset())},[t]),o}function da(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const Bo=$.createContext(null);function fa({children:e}){const t=ne(),n=$.useCallback(a=>{const{nodes:l=[],setNodes:g,hasDefaultNodes:u,onNodesChange:d,nodeLookup:c,fitViewQueued:h}=t.getState();let y=l;for(const b of a)y=typeof b=="function"?b(y):b;const p=An({items:y,lookup:c});u&&g(y),p.length>0?d==null||d(p):h&&window.requestAnimationFrame(()=>{const{fitViewQueued:b,nodes:m,setNodes:N}=t.getState();b&&N(m)})},[]),o=jn(n),s=$.useCallback(a=>{const{edges:l=[],setEdges:g,hasDefaultEdges:u,onEdgesChange:d,edgeLookup:c}=t.getState();let h=l;for(const y of a)h=typeof y=="function"?y(h):y;u?g(h):d&&d(An({items:h,lookup:c}))},[]),r=jn(s),i=$.useMemo(()=>({nodeQueue:o,edgeQueue:r}),[]);return E.jsx(Bo.Provider,{value:i,children:e})}function ha(){const e=$.useContext(Bo);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const ga=e=>!!e.panZoom;function Zt(){const e=aa(),t=ne(),n=ha(),o=J(ga),s=$.useMemo(()=>{const r=d=>t.getState().nodeLookup.get(d),i=d=>{n.nodeQueue.push(d)},a=d=>{n.edgeQueue.push(d)},l=d=>{var m,N;const{nodeLookup:c,nodeOrigin:h}=t.getState(),y=Tn(d)?d:c.get(d.id),p=y.parentId?uo(y.position,y.measured,y.parentId,c,h):y.position,b={...y,position:p,width:((m=y.measured)==null?void 0:m.width)??y.width,height:((N=y.measured)==null?void 0:N.height)??y.height};return Ie(b)},g=(d,c,h={replace:!1})=>{i(y=>y.map(p=>{if(p.id===d){const b=typeof c=="function"?c(p):c;return h.replace&&Tn(b)?b:{...p,...b}}return p}))},u=(d,c,h={replace:!1})=>{a(y=>y.map(p=>{if(p.id===d){const b=typeof c=="function"?c(p):c;return h.replace&&la(b)?b:{...p,...b}}return p}))};return{getNodes:()=>t.getState().nodes.map(d=>({...d})),getNode:d=>{var c;return(c=r(d))==null?void 0:c.internals.userNode},getInternalNode:r,getEdges:()=>{const{edges:d=[]}=t.getState();return d.map(c=>({...c}))},getEdge:d=>t.getState().edgeLookup.get(d),setNodes:i,setEdges:a,addNodes:d=>{const c=Array.isArray(d)?d:[d];n.nodeQueue.push(h=>[...h,...c])},addEdges:d=>{const c=Array.isArray(d)?d:[d];n.edgeQueue.push(h=>[...h,...c])},toObject:()=>{const{nodes:d=[],edges:c=[],transform:h}=t.getState(),[y,p,b]=h;return{nodes:d.map(m=>({...m})),edges:c.map(m=>({...m})),viewport:{x:y,y:p,zoom:b}}},deleteElements:async({nodes:d=[],edges:c=[]})=>{const{nodes:h,edges:y,onNodesDelete:p,onEdgesDelete:b,triggerNodeChanges:m,triggerEdgeChanges:N,onDelete:f,onBeforeDelete:w}=t.getState(),{nodes:v,edges:I}=await Xr({nodesToRemove:d,edgesToRemove:c,nodes:h,edges:y,onBeforeDelete:w}),_=I.length>0,P=v.length>0;if(_){const j=I.map(zn);b==null||b(I),N(j)}if(P){const j=v.map(zn);p==null||p(v),m(j)}return(P||_)&&(f==null||f({nodes:v,edges:I})),{deletedNodes:v,deletedEdges:I}},getIntersectingNodes:(d,c=!0,h)=>{const y=dn(d),p=y?d:l(d),b=h!==void 0;return p?(h||t.getState().nodes).filter(m=>{const N=t.getState().nodeLookup.get(m.id);if(N&&!y&&(m.id===d.id||!N.internals.positionAbsolute))return!1;const f=Ie(b?m:N),w=Be(f,p);return c&&w>0||w>=f.width*f.height||w>=p.width*p.height}):[]},isNodeIntersecting:(d,c,h=!0)=>{const p=dn(d)?d:l(d);if(!p)return!1;const b=Be(p,c);return h&&b>0||b>=p.width*p.height},updateNode:g,updateNodeData:(d,c,h={replace:!1})=>{g(d,y=>{const p=typeof c=="function"?c(y):c;return h.replace?{...y,data:p}:{...y,data:{...y.data,...p}}},h)},updateEdge:u,updateEdgeData:(d,c,h={replace:!1})=>{u(d,y=>{const p=typeof c=="function"?c(y):c;return h.replace?{...y,data:p}:{...y,data:{...y.data,...p}}},h)},getNodesBounds:d=>{const{nodeLookup:c,nodeOrigin:h}=t.getState();return Vr(d,{nodeLookup:c,nodeOrigin:h})},getHandleConnections:({type:d,id:c,nodeId:h})=>{var y;return Array.from(((y=t.getState().connectionLookup.get(`${h}-${d}${c?`-${c}`:""}`))==null?void 0:y.values())??[])},getNodeConnections:({type:d,handleId:c,nodeId:h})=>{var y;return Array.from(((y=t.getState().connectionLookup.get(`${h}${d?c?`-${d}-${c}`:`-${d}`:""}`))==null?void 0:y.values())??[])},fitView:async d=>{const c=t.getState().fitViewResolver??Zr();return t.setState({fitViewQueued:!0,fitViewOptions:d,fitViewResolver:c}),n.nodeQueue.push(h=>[...h]),c.promise}}},[]);return $.useMemo(()=>({...s,...e,viewportInitialized:o}),[o])}const Ln=e=>e.selected,pa=typeof window<"u"?window:void 0;function ma({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=ne(),{deleteElements:o}=Zt(),s=Ve(e,{actInsideInputWithModifier:!1}),r=Ve(t,{target:pa});$.useEffect(()=>{if(s){const{edges:i,nodes:a}=n.getState();o({nodes:a.filter(Ln),edges:i.filter(Ln)}),n.setState({nodesSelectionActive:!1})}},[s]),$.useEffect(()=>{n.setState({multiSelectionActive:r})},[r])}function ya(e){const t=ne();$.useEffect(()=>{const n=()=>{var s,r;if(!e.current)return!1;const o=Yt(e.current);(o.height===0||o.width===0)&&((r=(s=t.getState()).onError)==null||r.call(s,"004",ue.error004())),t.setState({width:o.width||500,height:o.height||500})};if(e.current){n(),window.addEventListener("resize",n);const o=new ResizeObserver(()=>n());return o.observe(e.current),()=>{window.removeEventListener("resize",n),o&&e.current&&o.unobserve(e.current)}}},[])}const pt={position:"absolute",width:"100%",height:"100%",top:0,left:0},xa=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function wa({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:o=!1,panOnScrollSpeed:s=.5,panOnScrollMode:r=xe.Free,zoomOnDoubleClick:i=!0,panOnDrag:a=!0,defaultViewport:l,translateExtent:g,minZoom:u,maxZoom:d,zoomActivationKeyCode:c,preventScrolling:h=!0,children:y,noWheelClassName:p,noPanClassName:b,onViewportChange:m,isControlledViewport:N,paneClickDistance:f}){const w=ne(),v=$.useRef(null),{userSelectionActive:I,lib:_}=J(xa,oe),P=Ve(c),j=$.useRef();ya(v);const B=$.useCallback(A=>{m==null||m({x:A[0],y:A[1],zoom:A[2]}),N||w.setState({transform:A})},[m,N]);return $.useEffect(()=>{if(v.current){j.current=_i({domNode:v.current,minZoom:u,maxZoom:d,translateExtent:g,viewport:l,paneClickDistance:f,onDraggingChange:x=>w.setState({paneDragging:x}),onPanZoomStart:(x,C)=>{const{onViewportChangeStart:S,onMoveStart:M}=w.getState();M==null||M(x,C),S==null||S(C)},onPanZoom:(x,C)=>{const{onViewportChange:S,onMove:M}=w.getState();M==null||M(x,C),S==null||S(C)},onPanZoomEnd:(x,C)=>{const{onViewportChangeEnd:S,onMoveEnd:M}=w.getState();M==null||M(x,C),S==null||S(C)}});const{x:A,y:L,zoom:H}=j.current.getViewport();return w.setState({panZoom:j.current,transform:[A,L,H],domNode:v.current.closest(".react-flow")}),()=>{var x;(x=j.current)==null||x.destroy()}}},[]),$.useEffect(()=>{var A;(A=j.current)==null||A.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:o,panOnScrollSpeed:s,panOnScrollMode:r,zoomOnDoubleClick:i,panOnDrag:a,zoomActivationKeyPressed:P,preventScrolling:h,noPanClassName:b,userSelectionActive:I,noWheelClassName:p,lib:_,onTransformChange:B})},[e,t,n,o,s,r,i,a,P,h,b,I,p,_,B]),E.jsx("div",{className:"react-flow__renderer",ref:v,style:pt,children:y})}const ba=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function va(){const{userSelectionActive:e,userSelectionRect:t}=J(ba,oe);return e&&t?E.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const Pt=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},Ea=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function Sa({isSelecting:e,selectionKeyPressed:t,selectionMode:n=De.Full,panOnDrag:o,selectionOnDrag:s,onSelectionStart:r,onSelectionEnd:i,onPaneClick:a,onPaneContextMenu:l,onPaneScroll:g,onPaneMouseEnter:u,onPaneMouseMove:d,onPaneMouseLeave:c,children:h}){const y=ne(),{userSelectionActive:p,elementsSelectable:b,dragging:m,connectionInProgress:N}=J(Ea,oe),f=b&&(e||p),w=$.useRef(null),v=$.useRef(),I=$.useRef(new Set),_=$.useRef(new Set),P=$.useRef(!1),j=$.useRef(!1),B=M=>{if(P.current||N){P.current=!1;return}a==null||a(M),y.getState().resetSelectedElements(),y.setState({nodesSelectionActive:!1})},A=M=>{if(Array.isArray(o)&&(o!=null&&o.includes(2))){M.preventDefault();return}l==null||l(M)},L=g?M=>g(M):void 0,H=M=>{var R,O;const{resetSelectedElements:z,domNode:k}=y.getState();if(v.current=k==null?void 0:k.getBoundingClientRect(),!b||!e||M.button!==0||M.target!==w.current||!v.current)return;(O=(R=M.target)==null?void 0:R.setPointerCapture)==null||O.call(R,M.pointerId),j.current=!0,P.current=!1;const{x:T,y:D}=le(M.nativeEvent,v.current);z(),y.setState({userSelectionRect:{width:0,height:0,startX:T,startY:D,x:T,y:D}}),r==null||r(M)},x=M=>{const{userSelectionRect:z,transform:k,nodeLookup:T,edgeLookup:D,connectionLookup:R,triggerNodeChanges:O,triggerEdgeChanges:V,defaultEdgeOptions:X}=y.getState();if(!v.current||!z)return;P.current=!0;const{x:G,y:Y}=le(M.nativeEvent,v.current),{startX:F,startY:K}=z,ee={startX:F,startY:K,x:G<F?G:F,y:Y<K?Y:K,width:Math.abs(G-F),height:Math.abs(Y-K)},Q=I.current,Z=_.current;I.current=new Set(Ft(T,ee,k,n===De.Partial,!0).map(q=>q.id)),_.current=new Set;const U=(X==null?void 0:X.selectable)??!0;for(const q of I.current){const te=R.get(q);if(te)for(const{edgeId:se}of te.values()){const de=D.get(se);de&&(de.selectable??U)&&_.current.add(se)}}if(!fn(Q,I.current)){const q=Ne(T,I.current,!0);O(q)}if(!fn(Z,_.current)){const q=Ne(D,_.current);V(q)}y.setState({userSelectionRect:ee,userSelectionActive:!0,nodesSelectionActive:!1})},C=M=>{var k,T;if(M.button!==0||!j.current)return;(T=(k=M.target)==null?void 0:k.releasePointerCapture)==null||T.call(k,M.pointerId);const{userSelectionRect:z}=y.getState();!p&&z&&M.target===w.current&&(B==null||B(M)),y.setState({userSelectionActive:!1,userSelectionRect:null,nodesSelectionActive:I.current.size>0}),i==null||i(M),(t||s)&&(P.current=!1),j.current=!1},S=o===!0||Array.isArray(o)&&o.includes(0);return E.jsxs("div",{className:re(["react-flow__pane",{draggable:S,dragging:m,selection:e}]),onClick:f?void 0:Pt(B,w),onContextMenu:Pt(A,w),onWheel:Pt(L,w),onPointerEnter:f?void 0:u,onPointerDown:f?H:d,onPointerMove:f?x:d,onPointerUp:f?C:void 0,onPointerLeave:c,ref:w,style:pt,children:[h,E.jsx(va,{})]})}function Dt({id:e,store:t,unselect:n=!1,nodeRef:o}){const{addSelectedNodes:s,unselectNodesAndEdges:r,multiSelectionActive:i,nodeLookup:a,onError:l}=t.getState(),g=a.get(e);if(!g){l==null||l("012",ue.error012(e));return}t.setState({nodesSelectionActive:!1}),g.selected?(n||g.selected&&i)&&(r({nodes:[g],edges:[]}),requestAnimationFrame(()=>{var u;return(u=o==null?void 0:o.current)==null?void 0:u.blur()})):s([e])}function Ro({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:o,nodeId:s,isSelectable:r,nodeClickDistance:i}){const a=ne(),[l,g]=$.useState(!1),u=$.useRef();return $.useEffect(()=>{u.current=gi({getStoreItems:()=>a.getState(),onNodeMouseDown:d=>{Dt({id:d,store:a,nodeRef:e})},onDragStart:()=>{g(!0)},onDragStop:()=>{g(!1)}})},[]),$.useEffect(()=>{var d,c;if(t)(d=u.current)==null||d.destroy();else if(e.current)return(c=u.current)==null||c.update({noDragClassName:n,handleSelector:o,domNode:e.current,isSelectable:r,nodeId:s,nodeClickDistance:i}),()=>{var h;(h=u.current)==null||h.destroy()}},[n,o,t,r,e,s]),l}const Na=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function Vo(){const e=ne();return $.useCallback(n=>{const{nodeExtent:o,snapToGrid:s,snapGrid:r,nodesDraggable:i,onError:a,updateNodePositions:l,nodeLookup:g,nodeOrigin:u}=e.getState(),d=new Map,c=Na(i),h=s?r[0]:5,y=s?r[1]:5,p=n.direction.x*h*n.factor,b=n.direction.y*y*n.factor;for(const[,m]of g){if(!c(m))continue;let N={x:m.internals.positionAbsolute.x+p,y:m.internals.positionAbsolute.y+b};s&&(N=dt(N,r));const{position:f,positionAbsolute:w}=ro({nodeId:m.id,nextPosition:N,nodeLookup:g,nodeExtent:o,nodeOrigin:u,onError:a});m.position=f,m.internals.positionAbsolute=w,d.set(m.id,m)}l(d)},[])}const qt=$.createContext(null),Ca=qt.Provider;qt.Consumer;const Fo=()=>$.useContext(qt),Ma=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),ka=(e,t,n)=>o=>{const{connectionClickStartHandle:s,connectionMode:r,connection:i}=o,{fromHandle:a,toHandle:l,isValid:g}=i,u=(l==null?void 0:l.nodeId)===e&&(l==null?void 0:l.id)===t&&(l==null?void 0:l.type)===n;return{connectingFrom:(a==null?void 0:a.nodeId)===e&&(a==null?void 0:a.id)===t&&(a==null?void 0:a.type)===n,connectingTo:u,clickConnecting:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.id)===t&&(s==null?void 0:s.type)===n,isPossibleEndHandle:r===Me.Strict?(a==null?void 0:a.type)!==n:e!==(a==null?void 0:a.nodeId)||t!==(a==null?void 0:a.id),connectionInProcess:!!a,clickConnectionInProcess:!!s,valid:u&&g}};function Ia({type:e="source",position:t=W.Top,isValidConnection:n,isConnectable:o=!0,isConnectableStart:s=!0,isConnectableEnd:r=!0,id:i,onConnect:a,children:l,className:g,onMouseDown:u,onTouchStart:d,...c},h){var C,S;const y=i||null,p=e==="target",b=ne(),m=Fo(),{connectOnClick:N,noPanClassName:f,rfId:w}=J(Ma,oe),{connectingFrom:v,connectingTo:I,clickConnecting:_,isPossibleEndHandle:P,connectionInProcess:j,clickConnectionInProcess:B,valid:A}=J(ka(m,y,e),oe);m||(S=(C=b.getState()).onError)==null||S.call(C,"010",ue.error010());const L=M=>{const{defaultEdgeOptions:z,onConnect:k,hasDefaultEdges:T}=b.getState(),D={...z,...M};if(T){const{edges:R,setEdges:O}=b.getState();O(xo(D,R))}k==null||k(D),a==null||a(D)},H=M=>{if(!m)return;const z=go(M.nativeEvent);if(s&&(z&&M.button===0||!z)){const k=b.getState();Ht.onPointerDown(M.nativeEvent,{autoPanOnConnect:k.autoPanOnConnect,connectionMode:k.connectionMode,connectionRadius:k.connectionRadius,domNode:k.domNode,nodeLookup:k.nodeLookup,lib:k.lib,isTarget:p,handleId:y,nodeId:m,flowId:k.rfId,panBy:k.panBy,cancelConnection:k.cancelConnection,onConnectStart:k.onConnectStart,onConnectEnd:k.onConnectEnd,updateConnection:k.updateConnection,onConnect:L,isValidConnection:n||k.isValidConnection,getTransform:()=>b.getState().transform,getFromHandle:()=>b.getState().connection.fromHandle,autoPanSpeed:k.autoPanSpeed,dragThreshold:k.connectionDragThreshold})}z?u==null||u(M):d==null||d(M)},x=M=>{const{onClickConnectStart:z,onClickConnectEnd:k,connectionClickStartHandle:T,connectionMode:D,isValidConnection:R,lib:O,rfId:V,nodeLookup:X,connection:G}=b.getState();if(!m||!T&&!s)return;if(!T){z==null||z(M.nativeEvent,{nodeId:m,handleId:y,handleType:e}),b.setState({connectionClickStartHandle:{nodeId:m,type:e,id:y}});return}const Y=fo(M.target),F=n||R,{connection:K,isValid:ee}=Ht.isValid(M.nativeEvent,{handle:{nodeId:m,id:y,type:e},connectionMode:D,fromNodeId:T.nodeId,fromHandleId:T.id||null,fromType:T.type,isValidConnection:F,flowId:V,doc:Y,lib:O,nodeLookup:X});ee&&K&&L(K);const Q=structuredClone(G);delete Q.inProgress,Q.toPosition=Q.toHandle?Q.toHandle.position:null,k==null||k(M,Q),b.setState({connectionClickStartHandle:null})};return E.jsx("div",{"data-handleid":y,"data-nodeid":m,"data-handlepos":t,"data-id":`${w}-${m}-${y}-${e}`,className:re(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",f,g,{source:!p,target:p,connectable:o,connectablestart:s,connectableend:r,clickconnecting:_,connectingfrom:v,connectingto:I,valid:A,connectionindicator:o&&(!j||P)&&(j||B?r:s)}]),onMouseDown:H,onTouchStart:H,onClick:N?x:void 0,ref:h,...c,children:l})}const at=$.memo(Do(Ia));function _a({data:e,isConnectable:t,sourcePosition:n=W.Bottom}){return E.jsxs(E.Fragment,{children:[e==null?void 0:e.label,E.jsx(at,{type:"source",position:n,isConnectable:t})]})}function Pa({data:e,isConnectable:t,targetPosition:n=W.Top,sourcePosition:o=W.Bottom}){return E.jsxs(E.Fragment,{children:[E.jsx(at,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,E.jsx(at,{type:"source",position:o,isConnectable:t})]})}function $a(){return null}function Aa({data:e,isConnectable:t,targetPosition:n=W.Top}){return E.jsxs(E.Fragment,{children:[E.jsx(at,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]})}const ct={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},Hn={input:_a,default:Pa,output:Aa,group:$a};function za(e){var t,n,o,s;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((n=e.style)==null?void 0:n.height)}:{width:e.width??((o=e.style)==null?void 0:o.width),height:e.height??((s=e.style)==null?void 0:s.height)}}const Ta=e=>{const{width:t,height:n,x:o,y:s}=Oe(e.nodeLookup,{filter:r=>!!r.selected});return{width:ce(t)?t:null,height:ce(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${o}px,${s}px)`}};function ja({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const o=ne(),{width:s,height:r,transformString:i,userSelectionActive:a}=J(Ta,oe),l=Vo(),g=$.useRef(null);if($.useEffect(()=>{var c;n||(c=g.current)==null||c.focus({preventScroll:!0})},[n]),Ro({nodeRef:g}),a||!s||!r)return null;const u=e?c=>{const h=o.getState().nodes.filter(y=>y.selected);e(c,h)}:void 0,d=c=>{Object.prototype.hasOwnProperty.call(ct,c.key)&&(c.preventDefault(),l({direction:ct[c.key],factor:c.shiftKey?4:1}))};return E.jsx("div",{className:re(["react-flow__nodesselection","react-flow__container",t]),style:{transform:i},children:E.jsx("div",{ref:g,className:"react-flow__nodesselection-rect",onContextMenu:u,tabIndex:n?void 0:-1,onKeyDown:n?void 0:d,style:{width:s,height:r}})})}const Dn=typeof window<"u"?window:void 0,La=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function Oo({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:r,onPaneScroll:i,paneClickDistance:a,deleteKeyCode:l,selectionKeyCode:g,selectionOnDrag:u,selectionMode:d,onSelectionStart:c,onSelectionEnd:h,multiSelectionKeyCode:y,panActivationKeyCode:p,zoomActivationKeyCode:b,elementsSelectable:m,zoomOnScroll:N,zoomOnPinch:f,panOnScroll:w,panOnScrollSpeed:v,panOnScrollMode:I,zoomOnDoubleClick:_,panOnDrag:P,defaultViewport:j,translateExtent:B,minZoom:A,maxZoom:L,preventScrolling:H,onSelectionContextMenu:x,noWheelClassName:C,noPanClassName:S,disableKeyboardA11y:M,onViewportChange:z,isControlledViewport:k}){const{nodesSelectionActive:T,userSelectionActive:D}=J(La),R=Ve(g,{target:Dn}),O=Ve(p,{target:Dn}),V=O||P,X=O||w,G=u&&V!==!0,Y=R||D||G;return ma({deleteKeyCode:l,multiSelectionKeyCode:y}),E.jsx(wa,{onPaneContextMenu:r,elementsSelectable:m,zoomOnScroll:N,zoomOnPinch:f,panOnScroll:X,panOnScrollSpeed:v,panOnScrollMode:I,zoomOnDoubleClick:_,panOnDrag:!R&&V,defaultViewport:j,translateExtent:B,minZoom:A,maxZoom:L,zoomActivationKeyCode:b,preventScrolling:H,noWheelClassName:C,noPanClassName:S,onViewportChange:z,isControlledViewport:k,paneClickDistance:a,children:E.jsxs(Sa,{onSelectionStart:c,onSelectionEnd:h,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:r,onPaneScroll:i,panOnDrag:V,isSelecting:!!Y,selectionMode:d,selectionKeyPressed:R,selectionOnDrag:G,children:[e,T&&E.jsx(ja,{onSelectionContextMenu:x,noPanClassName:S,disableKeyboardA11y:M})]})})}Oo.displayName="FlowRenderer";const Ha=$.memo(Oo),Da=e=>t=>e?Ft(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function Ba(e){return J($.useCallback(Da(e),[e]),oe)}const Ra=e=>e.updateNodeInternals;function Va(){const e=J(Ra),[t]=$.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const o=new Map;n.forEach(s=>{const r=s.target.getAttribute("data-id");o.set(r,{id:r,nodeElement:s.target,force:!0})}),e(o)}));return $.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function Fa({node:e,nodeType:t,hasDimensions:n,resizeObserver:o}){const s=ne(),r=$.useRef(null),i=$.useRef(null),a=$.useRef(e.sourcePosition),l=$.useRef(e.targetPosition),g=$.useRef(t),u=n&&!!e.internals.handleBounds;return $.useEffect(()=>{r.current&&!e.hidden&&(!u||i.current!==r.current)&&(i.current&&(o==null||o.unobserve(i.current)),o==null||o.observe(r.current),i.current=r.current)},[u,e.hidden]),$.useEffect(()=>()=>{i.current&&(o==null||o.unobserve(i.current),i.current=null)},[]),$.useEffect(()=>{if(r.current){const d=g.current!==t,c=a.current!==e.sourcePosition,h=l.current!==e.targetPosition;(d||c||h)&&(g.current=t,a.current=e.sourcePosition,l.current=e.targetPosition,s.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:r.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),r}function Oa({id:e,onClick:t,onMouseEnter:n,onMouseMove:o,onMouseLeave:s,onContextMenu:r,onDoubleClick:i,nodesDraggable:a,elementsSelectable:l,nodesConnectable:g,nodesFocusable:u,resizeObserver:d,noDragClassName:c,noPanClassName:h,disableKeyboardA11y:y,rfId:p,nodeTypes:b,nodeClickDistance:m,onError:N}){const{node:f,internals:w,isParent:v}=J(F=>{const K=F.nodeLookup.get(e),ee=F.parentLookup.has(e);return{node:K,internals:K.internals,isParent:ee}},oe);let I=f.type||"default",_=(b==null?void 0:b[I])||Hn[I];_===void 0&&(N==null||N("003",ue.error003(I)),I="default",_=(b==null?void 0:b.default)||Hn.default);const P=!!(f.draggable||a&&typeof f.draggable>"u"),j=!!(f.selectable||l&&typeof f.selectable>"u"),B=!!(f.connectable||g&&typeof f.connectable>"u"),A=!!(f.focusable||u&&typeof f.focusable>"u"),L=ne(),H=lo(f),x=Fa({node:f,nodeType:I,hasDimensions:H,resizeObserver:d}),C=Ro({nodeRef:x,disabled:f.hidden||!P,noDragClassName:c,handleSelector:f.dragHandle,nodeId:e,isSelectable:j,nodeClickDistance:m}),S=Vo();if(f.hidden)return null;const M=fe(f),z=za(f),k=j||P||t||n||o||s,T=n?F=>n(F,{...w.userNode}):void 0,D=o?F=>o(F,{...w.userNode}):void 0,R=s?F=>s(F,{...w.userNode}):void 0,O=r?F=>r(F,{...w.userNode}):void 0,V=i?F=>i(F,{...w.userNode}):void 0,X=F=>{const{selectNodesOnDrag:K,nodeDragThreshold:ee}=L.getState();j&&(!K||!P||ee>0)&&Dt({id:e,store:L,nodeRef:x}),t&&t(F,{...w.userNode})},G=F=>{if(!(ho(F.nativeEvent)||y)){if(eo.includes(F.key)&&j){const K=F.key==="Escape";Dt({id:e,store:L,unselect:K,nodeRef:x})}else if(P&&f.selected&&Object.prototype.hasOwnProperty.call(ct,F.key)){F.preventDefault();const{ariaLabelConfig:K}=L.getState();L.setState({ariaLiveMessage:K["node.a11yDescription.ariaLiveMessage"]({direction:F.key.replace("Arrow","").toLowerCase(),x:~~w.positionAbsolute.x,y:~~w.positionAbsolute.y})}),S({direction:ct[F.key],factor:F.shiftKey?4:1})}}},Y=()=>{var q;if(y||!((q=x.current)!=null&&q.matches(":focus-visible")))return;const{transform:F,width:K,height:ee,autoPanOnNodeFocus:Q,setCenter:Z}=L.getState();if(!Q)return;Ft(new Map([[e,f]]),{x:0,y:0,width:K,height:ee},F,!0).length>0||Z(f.position.x+M.width/2,f.position.y+M.height/2,{zoom:F[2]})};return E.jsx("div",{className:re(["react-flow__node",`react-flow__node-${I}`,{[h]:P},f.className,{selected:f.selected,selectable:j,parent:v,draggable:P,dragging:C}]),ref:x,style:{zIndex:w.z,transform:`translate(${w.positionAbsolute.x}px,${w.positionAbsolute.y}px)`,pointerEvents:k?"all":"none",visibility:H?"visible":"hidden",...f.style,...z},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:T,onMouseMove:D,onMouseLeave:R,onContextMenu:O,onClick:X,onDoubleClick:V,onKeyDown:A?G:void 0,tabIndex:A?0:void 0,onFocus:A?Y:void 0,role:f.ariaRole??(A?"group":void 0),"aria-roledescription":"node","aria-describedby":y?void 0:`${Ao}-${p}`,"aria-label":f.ariaLabel,...f.domAttributes,children:E.jsx(Ca,{value:e,children:E.jsx(_,{id:e,data:f.data,type:I,positionAbsoluteX:w.positionAbsolute.x,positionAbsoluteY:w.positionAbsolute.y,selected:f.selected??!1,selectable:j,draggable:P,deletable:f.deletable??!0,isConnectable:B,sourcePosition:f.sourcePosition,targetPosition:f.targetPosition,dragging:C,dragHandle:f.dragHandle,zIndex:w.z,parentId:f.parentId,...M})})})}const Ya=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function Yo(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:s,onError:r}=J(Ya,oe),i=Ba(e.onlyRenderVisibleElements),a=Va();return E.jsx("div",{className:"react-flow__nodes",style:pt,children:i.map(l=>E.jsx(Oa,{id:l,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:a,nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:s,nodeClickDistance:e.nodeClickDistance,onError:r},l))})}Yo.displayName="NodeRenderer";const Xa=$.memo(Yo);function Wa(e){return J($.useCallback(n=>{if(!e)return n.edges.map(s=>s.id);const o=[];if(n.width&&n.height)for(const s of n.edges){const r=n.nodeLookup.get(s.source),i=n.nodeLookup.get(s.target);r&&i&&Jr({sourceNode:r,targetNode:i,width:n.width,height:n.height,transform:n.transform})&&o.push(s.id)}return o},[e]),oe)}const Ga=({color:e="none",strokeWidth:t=1})=>E.jsx("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),Ka=({color:e="none",strokeWidth:t=1})=>E.jsx("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),Bn={[ot.Arrow]:Ga,[ot.ArrowClosed]:Ka};function Za(e){const t=ne();return $.useMemo(()=>{var s,r;return Object.prototype.hasOwnProperty.call(Bn,e)?Bn[e]:((r=(s=t.getState()).onError)==null||r.call(s,"009",ue.error009(e)),null)},[e])}const qa=({id:e,type:t,color:n,width:o=12.5,height:s=12.5,markerUnits:r="strokeWidth",strokeWidth:i,orient:a="auto-start-reverse"})=>{const l=Za(t);return l?E.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:r,orient:a,refX:"0",refY:"0",children:E.jsx(l,{color:n,strokeWidth:i})}):null},Xo=({defaultColor:e,rfId:t})=>{const n=J(r=>r.edges),o=J(r=>r.defaultEdgeOptions),s=$.useMemo(()=>ii(n,{id:t,defaultColor:e,defaultMarkerStart:o==null?void 0:o.markerStart,defaultMarkerEnd:o==null?void 0:o.markerEnd}),[n,o,t,e]);return s.length?E.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:E.jsx("defs",{children:s.map(r=>E.jsx(qa,{id:r.id,type:r.type,color:r.color,width:r.width,height:r.height,markerUnits:r.markerUnits,strokeWidth:r.strokeWidth,orient:r.orient},r.id))})}):null};Xo.displayName="MarkerDefinitions";var Ua=$.memo(Xo);function Wo({x:e,y:t,label:n,labelStyle:o,labelShowBg:s=!0,labelBgStyle:r,labelBgPadding:i=[2,4],labelBgBorderRadius:a=2,children:l,className:g,...u}){const[d,c]=$.useState({x:1,y:0,width:0,height:0}),h=re(["react-flow__edge-textwrapper",g]),y=$.useRef(null);return $.useEffect(()=>{if(y.current){const p=y.current.getBBox();c({x:p.x,y:p.y,width:p.width,height:p.height})}},[n]),n?E.jsxs("g",{transform:`translate(${e-d.width/2} ${t-d.height/2})`,className:h,visibility:d.width?"visible":"hidden",...u,children:[s&&E.jsx("rect",{width:d.width+2*i[0],x:-i[0],y:-i[1],height:d.height+2*i[1],className:"react-flow__edge-textbg",style:r,rx:a,ry:a}),E.jsx("text",{className:"react-flow__edge-text",y:d.height/2,dy:"0.3em",ref:y,style:o,children:n}),l]}):null}Wo.displayName="EdgeText";const Qa=$.memo(Wo);function mt({path:e,labelX:t,labelY:n,label:o,labelStyle:s,labelShowBg:r,labelBgStyle:i,labelBgPadding:a,labelBgBorderRadius:l,interactionWidth:g=20,...u}){return E.jsxs(E.Fragment,{children:[E.jsx("path",{...u,d:e,fill:"none",className:re(["react-flow__edge-path",u.className])}),g&&E.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:g,className:"react-flow__edge-interaction"}),o&&ce(t)&&ce(n)?E.jsx(Qa,{x:t,y:n,label:o,labelStyle:s,labelShowBg:r,labelBgStyle:i,labelBgPadding:a,labelBgBorderRadius:l}):null]})}function Rn({pos:e,x1:t,y1:n,x2:o,y2:s}){return e===W.Left||e===W.Right?[.5*(t+o),n]:[t,.5*(n+s)]}function Go({sourceX:e,sourceY:t,sourcePosition:n=W.Bottom,targetX:o,targetY:s,targetPosition:r=W.Top}){const[i,a]=Rn({pos:n,x1:e,y1:t,x2:o,y2:s}),[l,g]=Rn({pos:r,x1:o,y1:s,x2:e,y2:t}),[u,d,c,h]=po({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:i,sourceControlY:a,targetControlX:l,targetControlY:g});return[`M${e},${t} C${i},${a} ${l},${g} ${o},${s}`,u,d,c,h]}function Ko(e){return $.memo(({id:t,sourceX:n,sourceY:o,targetX:s,targetY:r,sourcePosition:i,targetPosition:a,label:l,labelStyle:g,labelShowBg:u,labelBgStyle:d,labelBgPadding:c,labelBgBorderRadius:h,style:y,markerEnd:p,markerStart:b,interactionWidth:m})=>{const[N,f,w]=Go({sourceX:n,sourceY:o,sourcePosition:i,targetX:s,targetY:r,targetPosition:a}),v=e.isInternal?void 0:t;return E.jsx(mt,{id:v,path:N,labelX:f,labelY:w,label:l,labelStyle:g,labelShowBg:u,labelBgStyle:d,labelBgPadding:c,labelBgBorderRadius:h,style:y,markerEnd:p,markerStart:b,interactionWidth:m})})}const Ja=Ko({isInternal:!1}),Zo=Ko({isInternal:!0});Ja.displayName="SimpleBezierEdge";Zo.displayName="SimpleBezierEdgeInternal";function qo(e){return $.memo(({id:t,sourceX:n,sourceY:o,targetX:s,targetY:r,label:i,labelStyle:a,labelShowBg:l,labelBgStyle:g,labelBgPadding:u,labelBgBorderRadius:d,style:c,sourcePosition:h=W.Bottom,targetPosition:y=W.Top,markerEnd:p,markerStart:b,pathOptions:m,interactionWidth:N})=>{const[f,w,v]=Tt({sourceX:n,sourceY:o,sourcePosition:h,targetX:s,targetY:r,targetPosition:y,borderRadius:m==null?void 0:m.borderRadius,offset:m==null?void 0:m.offset,stepPosition:m==null?void 0:m.stepPosition}),I=e.isInternal?void 0:t;return E.jsx(mt,{id:I,path:f,labelX:w,labelY:v,label:i,labelStyle:a,labelShowBg:l,labelBgStyle:g,labelBgPadding:u,labelBgBorderRadius:d,style:c,markerEnd:p,markerStart:b,interactionWidth:N})})}const Uo=qo({isInternal:!1}),Qo=qo({isInternal:!0});Uo.displayName="SmoothStepEdge";Qo.displayName="SmoothStepEdgeInternal";function Jo(e){return $.memo(({id:t,...n})=>{var s;const o=e.isInternal?void 0:t;return E.jsx(Uo,{...n,id:o,pathOptions:$.useMemo(()=>{var r;return{borderRadius:0,offset:(r=n.pathOptions)==null?void 0:r.offset}},[(s=n.pathOptions)==null?void 0:s.offset])})})}const ec=Jo({isInternal:!1}),es=Jo({isInternal:!0});ec.displayName="StepEdge";es.displayName="StepEdgeInternal";function ts(e){return $.memo(({id:t,sourceX:n,sourceY:o,targetX:s,targetY:r,label:i,labelStyle:a,labelShowBg:l,labelBgStyle:g,labelBgPadding:u,labelBgBorderRadius:d,style:c,markerEnd:h,markerStart:y,interactionWidth:p})=>{const[b,m,N]=wo({sourceX:n,sourceY:o,targetX:s,targetY:r}),f=e.isInternal?void 0:t;return E.jsx(mt,{id:f,path:b,labelX:m,labelY:N,label:i,labelStyle:a,labelShowBg:l,labelBgStyle:g,labelBgPadding:u,labelBgBorderRadius:d,style:c,markerEnd:h,markerStart:y,interactionWidth:p})})}const tc=ts({isInternal:!1}),ns=ts({isInternal:!0});tc.displayName="StraightEdge";ns.displayName="StraightEdgeInternal";function os(e){return $.memo(({id:t,sourceX:n,sourceY:o,targetX:s,targetY:r,sourcePosition:i=W.Bottom,targetPosition:a=W.Top,label:l,labelStyle:g,labelShowBg:u,labelBgStyle:d,labelBgPadding:c,labelBgBorderRadius:h,style:y,markerEnd:p,markerStart:b,pathOptions:m,interactionWidth:N})=>{const[f,w,v]=mo({sourceX:n,sourceY:o,sourcePosition:i,targetX:s,targetY:r,targetPosition:a,curvature:m==null?void 0:m.curvature}),I=e.isInternal?void 0:t;return E.jsx(mt,{id:I,path:f,labelX:w,labelY:v,label:l,labelStyle:g,labelShowBg:u,labelBgStyle:d,labelBgPadding:c,labelBgBorderRadius:h,style:y,markerEnd:p,markerStart:b,interactionWidth:N})})}const nc=os({isInternal:!1}),ss=os({isInternal:!0});nc.displayName="BezierEdge";ss.displayName="BezierEdgeInternal";const Vn={default:ss,straight:ns,step:es,smoothstep:Qo,simplebezier:Zo},Fn={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},oc=(e,t,n)=>n===W.Left?e-t:n===W.Right?e+t:e,sc=(e,t,n)=>n===W.Top?e-t:n===W.Bottom?e+t:e,On="react-flow__edgeupdater";function Yn({position:e,centerX:t,centerY:n,radius:o=10,onMouseDown:s,onMouseEnter:r,onMouseOut:i,type:a}){return E.jsx("circle",{onMouseDown:s,onMouseEnter:r,onMouseOut:i,className:re([On,`${On}-${a}`]),cx:oc(t,o,e),cy:sc(n,o,e),r:o,stroke:"transparent",fill:"transparent"})}function rc({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:o,sourceY:s,targetX:r,targetY:i,sourcePosition:a,targetPosition:l,onReconnect:g,onReconnectStart:u,onReconnectEnd:d,setReconnecting:c,setUpdateHover:h}){const y=ne(),p=(w,v)=>{if(w.button!==0)return;const{autoPanOnConnect:I,domNode:_,isValidConnection:P,connectionMode:j,connectionRadius:B,lib:A,onConnectStart:L,onConnectEnd:H,cancelConnection:x,nodeLookup:C,rfId:S,panBy:M,updateConnection:z}=y.getState(),k=v.type==="target",T=(O,V)=>{c(!1),d==null||d(O,n,v.type,V)},D=O=>g==null?void 0:g(n,O),R=(O,V)=>{c(!0),u==null||u(w,n,v.type),L==null||L(O,V)};Ht.onPointerDown(w.nativeEvent,{autoPanOnConnect:I,connectionMode:j,connectionRadius:B,domNode:_,handleId:v.id,nodeId:v.nodeId,nodeLookup:C,isTarget:k,edgeUpdaterType:v.type,lib:A,flowId:S,cancelConnection:x,panBy:M,isValidConnection:P,onConnect:D,onConnectStart:R,onConnectEnd:H,onReconnectEnd:T,updateConnection:z,getTransform:()=>y.getState().transform,getFromHandle:()=>y.getState().connection.fromHandle,dragThreshold:y.getState().connectionDragThreshold})},b=w=>p(w,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),m=w=>p(w,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),N=()=>h(!0),f=()=>h(!1);return E.jsxs(E.Fragment,{children:[(e===!0||e==="source")&&E.jsx(Yn,{position:a,centerX:o,centerY:s,radius:t,onMouseDown:b,onMouseEnter:N,onMouseOut:f,type:"source"}),(e===!0||e==="target")&&E.jsx(Yn,{position:l,centerX:r,centerY:i,radius:t,onMouseDown:m,onMouseEnter:N,onMouseOut:f,type:"target"})]})}function ic({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:o,onClick:s,onDoubleClick:r,onContextMenu:i,onMouseEnter:a,onMouseMove:l,onMouseLeave:g,reconnectRadius:u,onReconnect:d,onReconnectStart:c,onReconnectEnd:h,rfId:y,edgeTypes:p,noPanClassName:b,onError:m,disableKeyboardA11y:N}){let f=J(Z=>Z.edgeLookup.get(e));const w=J(Z=>Z.defaultEdgeOptions);f=w?{...w,...f}:f;let v=f.type||"default",I=(p==null?void 0:p[v])||Vn[v];I===void 0&&(m==null||m("011",ue.error011(v)),v="default",I=(p==null?void 0:p.default)||Vn.default);const _=!!(f.focusable||t&&typeof f.focusable>"u"),P=typeof d<"u"&&(f.reconnectable||n&&typeof f.reconnectable>"u"),j=!!(f.selectable||o&&typeof f.selectable>"u"),B=$.useRef(null),[A,L]=$.useState(!1),[H,x]=$.useState(!1),C=ne(),{zIndex:S,sourceX:M,sourceY:z,targetX:k,targetY:T,sourcePosition:D,targetPosition:R}=J($.useCallback(Z=>{const U=Z.nodeLookup.get(f.source),q=Z.nodeLookup.get(f.target);if(!U||!q)return{zIndex:f.zIndex,...Fn};const te=ri({id:e,sourceNode:U,targetNode:q,sourceHandle:f.sourceHandle||null,targetHandle:f.targetHandle||null,connectionMode:Z.connectionMode,onError:m});return{zIndex:Qr({selected:f.selected,zIndex:f.zIndex,sourceNode:U,targetNode:q,elevateOnSelect:Z.elevateEdgesOnSelect}),...te||Fn}},[f.source,f.target,f.sourceHandle,f.targetHandle,f.selected,f.zIndex]),oe),O=$.useMemo(()=>f.markerStart?`url('#${jt(f.markerStart,y)}')`:void 0,[f.markerStart,y]),V=$.useMemo(()=>f.markerEnd?`url('#${jt(f.markerEnd,y)}')`:void 0,[f.markerEnd,y]);if(f.hidden||M===null||z===null||k===null||T===null)return null;const X=Z=>{var se;const{addSelectedEdges:U,unselectNodesAndEdges:q,multiSelectionActive:te}=C.getState();j&&(C.setState({nodesSelectionActive:!1}),f.selected&&te?(q({nodes:[],edges:[f]}),(se=B.current)==null||se.blur()):U([e])),s&&s(Z,f)},G=r?Z=>{r(Z,{...f})}:void 0,Y=i?Z=>{i(Z,{...f})}:void 0,F=a?Z=>{a(Z,{...f})}:void 0,K=l?Z=>{l(Z,{...f})}:void 0,ee=g?Z=>{g(Z,{...f})}:void 0,Q=Z=>{var U;if(!N&&eo.includes(Z.key)&&j){const{unselectNodesAndEdges:q,addSelectedEdges:te}=C.getState();Z.key==="Escape"?((U=B.current)==null||U.blur(),q({edges:[f]})):te([e])}};return E.jsx("svg",{style:{zIndex:S},children:E.jsxs("g",{className:re(["react-flow__edge",`react-flow__edge-${v}`,f.className,b,{selected:f.selected,animated:f.animated,inactive:!j&&!s,updating:A,selectable:j}]),onClick:X,onDoubleClick:G,onContextMenu:Y,onMouseEnter:F,onMouseMove:K,onMouseLeave:ee,onKeyDown:_?Q:void 0,tabIndex:_?0:void 0,role:f.ariaRole??(_?"group":"img"),"aria-roledescription":"edge","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":f.ariaLabel===null?void 0:f.ariaLabel||`Edge from ${f.source} to ${f.target}`,"aria-describedby":_?`${zo}-${y}`:void 0,ref:B,...f.domAttributes,children:[!H&&E.jsx(I,{id:e,source:f.source,target:f.target,type:f.type,selected:f.selected,animated:f.animated,selectable:j,deletable:f.deletable??!0,label:f.label,labelStyle:f.labelStyle,labelShowBg:f.labelShowBg,labelBgStyle:f.labelBgStyle,labelBgPadding:f.labelBgPadding,labelBgBorderRadius:f.labelBgBorderRadius,sourceX:M,sourceY:z,targetX:k,targetY:T,sourcePosition:D,targetPosition:R,data:f.data,style:f.style,sourceHandleId:f.sourceHandle,targetHandleId:f.targetHandle,markerStart:O,markerEnd:V,pathOptions:"pathOptions"in f?f.pathOptions:void 0,interactionWidth:f.interactionWidth}),P&&E.jsx(rc,{edge:f,isReconnectable:P,reconnectRadius:u,onReconnect:d,onReconnectStart:c,onReconnectEnd:h,sourceX:M,sourceY:z,targetX:k,targetY:T,sourcePosition:D,targetPosition:R,setUpdateHover:L,setReconnecting:x})]})})}const ac=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function rs({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:o,noPanClassName:s,onReconnect:r,onEdgeContextMenu:i,onEdgeMouseEnter:a,onEdgeMouseMove:l,onEdgeMouseLeave:g,onEdgeClick:u,reconnectRadius:d,onEdgeDoubleClick:c,onReconnectStart:h,onReconnectEnd:y,disableKeyboardA11y:p}){const{edgesFocusable:b,edgesReconnectable:m,elementsSelectable:N,onError:f}=J(ac,oe),w=Wa(t);return E.jsxs("div",{className:"react-flow__edges",children:[E.jsx(Ua,{defaultColor:e,rfId:n}),w.map(v=>E.jsx(ic,{id:v,edgesFocusable:b,edgesReconnectable:m,elementsSelectable:N,noPanClassName:s,onReconnect:r,onContextMenu:i,onMouseEnter:a,onMouseMove:l,onMouseLeave:g,onClick:u,reconnectRadius:d,onDoubleClick:c,onReconnectStart:h,onReconnectEnd:y,rfId:n,onError:f,edgeTypes:o,disableKeyboardA11y:p},v))]})}rs.displayName="EdgeRenderer";const cc=$.memo(rs),lc=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function uc({children:e}){const t=J(lc);return E.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function dc(e){const t=Zt(),n=$.useRef(!1);$.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const fc=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function hc(e){const t=J(fc),n=ne();return $.useEffect(()=>{e&&(t==null||t(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function gc(e){return e.connection.inProgress?{...e.connection,to:Ye(e.connection.to,e.transform)}:{...e.connection}}function pc(e){return gc}function mc(e){const t=pc();return J(t,oe)}const yc=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function xc({containerStyle:e,style:t,type:n,component:o}){const{nodesConnectable:s,width:r,height:i,isValid:a,inProgress:l}=J(yc,oe);return!(r&&s&&l)?null:E.jsx("svg",{style:e,width:r,height:i,className:"react-flow__connectionline react-flow__container",children:E.jsx("g",{className:re(["react-flow__connection",oo(a)]),children:E.jsx(is,{style:t,type:n,CustomComponent:o,isValid:a})})})}const is=({style:e,type:t=pe.Bezier,CustomComponent:n,isValid:o})=>{const{inProgress:s,from:r,fromNode:i,fromHandle:a,fromPosition:l,to:g,toNode:u,toHandle:d,toPosition:c}=mc();if(!s)return;if(n)return E.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:i,fromHandle:a,fromX:r.x,fromY:r.y,toX:g.x,toY:g.y,fromPosition:l,toPosition:c,connectionStatus:oo(o),toNode:u,toHandle:d});let h="";const y={sourceX:r.x,sourceY:r.y,sourcePosition:l,targetX:g.x,targetY:g.y,targetPosition:c};switch(t){case pe.Bezier:[h]=mo(y);break;case pe.SimpleBezier:[h]=Go(y);break;case pe.Step:[h]=Tt({...y,borderRadius:0});break;case pe.SmoothStep:[h]=Tt(y);break;default:[h]=wo(y)}return E.jsx("path",{d:h,fill:"none",className:"react-flow__connection-path",style:e})};is.displayName="ConnectionLine";const wc={};function Xn(e=wc){$.useRef(e),ne(),$.useEffect(()=>{},[e])}function bc(){ne(),$.useRef(!1),$.useEffect(()=>{},[])}function as({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:o,onEdgeClick:s,onNodeDoubleClick:r,onEdgeDoubleClick:i,onNodeMouseEnter:a,onNodeMouseMove:l,onNodeMouseLeave:g,onNodeContextMenu:u,onSelectionContextMenu:d,onSelectionStart:c,onSelectionEnd:h,connectionLineType:y,connectionLineStyle:p,connectionLineComponent:b,connectionLineContainerStyle:m,selectionKeyCode:N,selectionOnDrag:f,selectionMode:w,multiSelectionKeyCode:v,panActivationKeyCode:I,zoomActivationKeyCode:_,deleteKeyCode:P,onlyRenderVisibleElements:j,elementsSelectable:B,defaultViewport:A,translateExtent:L,minZoom:H,maxZoom:x,preventScrolling:C,defaultMarkerColor:S,zoomOnScroll:M,zoomOnPinch:z,panOnScroll:k,panOnScrollSpeed:T,panOnScrollMode:D,zoomOnDoubleClick:R,panOnDrag:O,onPaneClick:V,onPaneMouseEnter:X,onPaneMouseMove:G,onPaneMouseLeave:Y,onPaneScroll:F,onPaneContextMenu:K,paneClickDistance:ee,nodeClickDistance:Q,onEdgeContextMenu:Z,onEdgeMouseEnter:U,onEdgeMouseMove:q,onEdgeMouseLeave:te,reconnectRadius:se,onReconnect:de,onReconnectStart:be,onReconnectEnd:Xe,noDragClassName:We,noWheelClassName:Ge,noPanClassName:$e,disableKeyboardA11y:Ae,nodeExtent:yt,rfId:Ke,viewport:ve,onViewportChange:ze}){return Xn(e),Xn(t),bc(),dc(n),hc(ve),E.jsx(Ha,{onPaneClick:V,onPaneMouseEnter:X,onPaneMouseMove:G,onPaneMouseLeave:Y,onPaneContextMenu:K,onPaneScroll:F,paneClickDistance:ee,deleteKeyCode:P,selectionKeyCode:N,selectionOnDrag:f,selectionMode:w,onSelectionStart:c,onSelectionEnd:h,multiSelectionKeyCode:v,panActivationKeyCode:I,zoomActivationKeyCode:_,elementsSelectable:B,zoomOnScroll:M,zoomOnPinch:z,zoomOnDoubleClick:R,panOnScroll:k,panOnScrollSpeed:T,panOnScrollMode:D,panOnDrag:O,defaultViewport:A,translateExtent:L,minZoom:H,maxZoom:x,onSelectionContextMenu:d,preventScrolling:C,noDragClassName:We,noWheelClassName:Ge,noPanClassName:$e,disableKeyboardA11y:Ae,onViewportChange:ze,isControlledViewport:!!ve,children:E.jsxs(uc,{children:[E.jsx(cc,{edgeTypes:t,onEdgeClick:s,onEdgeDoubleClick:i,onReconnect:de,onReconnectStart:be,onReconnectEnd:Xe,onlyRenderVisibleElements:j,onEdgeContextMenu:Z,onEdgeMouseEnter:U,onEdgeMouseMove:q,onEdgeMouseLeave:te,reconnectRadius:se,defaultMarkerColor:S,noPanClassName:$e,disableKeyboardA11y:Ae,rfId:Ke}),E.jsx(xc,{style:p,type:y,component:b,containerStyle:m}),E.jsx("div",{className:"react-flow__edgelabel-renderer"}),E.jsx(Xa,{nodeTypes:e,onNodeClick:o,onNodeDoubleClick:r,onNodeMouseEnter:a,onNodeMouseMove:l,onNodeMouseLeave:g,onNodeContextMenu:u,nodeClickDistance:Q,onlyRenderVisibleElements:j,noPanClassName:$e,noDragClassName:We,disableKeyboardA11y:Ae,nodeExtent:yt,rfId:Ke}),E.jsx("div",{className:"react-flow__viewport-portal"})]})})}as.displayName="GraphView";const vc=$.memo(as),Wn=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:s,height:r,fitView:i,fitViewOptions:a,minZoom:l=.5,maxZoom:g=2,nodeOrigin:u,nodeExtent:d}={})=>{const c=new Map,h=new Map,y=new Map,p=new Map,b=o??t??[],m=n??e??[],N=u??[0,0],f=d??He;vo(y,p,b);const w=Lt(m,c,h,{nodeOrigin:N,nodeExtent:f,elevateNodesOnSelect:!1});let v=[0,0,1];if(i&&s&&r){const I=Oe(c,{filter:B=>!!((B.width||B.initialWidth)&&(B.height||B.initialHeight))}),{x:_,y:P,zoom:j}=Ot(I,s,r,l,g,(a==null?void 0:a.padding)??.1);v=[_,P,j]}return{rfId:"1",width:0,height:0,transform:v,nodes:m,nodesInitialized:w,nodeLookup:c,parentLookup:h,edges:b,edgeLookup:p,connectionLookup:y,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:o!==void 0,panZoom:null,minZoom:l,maxZoom:g,translateExtent:He,nodeExtent:f,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Me.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:N,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:i??!1,fitViewOptions:a,fitViewResolver:null,connection:{...no},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:Wr,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:to}},Ec=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:s,height:r,fitView:i,fitViewOptions:a,minZoom:l,maxZoom:g,nodeOrigin:u,nodeExtent:d})=>Fi((c,h)=>{async function y(){const{nodeLookup:p,panZoom:b,fitViewOptions:m,fitViewResolver:N,width:f,height:w,minZoom:v,maxZoom:I}=h();b&&(await Yr({nodes:p,width:f,height:w,panZoom:b,minZoom:v,maxZoom:I},m),N==null||N.resolve(!0),c({fitViewResolver:null}))}return{...Wn({nodes:e,edges:t,width:s,height:r,fitView:i,fitViewOptions:a,minZoom:l,maxZoom:g,nodeOrigin:u,nodeExtent:d,defaultNodes:n,defaultEdges:o}),setNodes:p=>{const{nodeLookup:b,parentLookup:m,nodeOrigin:N,elevateNodesOnSelect:f,fitViewQueued:w}=h(),v=Lt(p,b,m,{nodeOrigin:N,nodeExtent:d,elevateNodesOnSelect:f,checkEquality:!0});w&&v?(y(),c({nodes:p,nodesInitialized:v,fitViewQueued:!1,fitViewOptions:void 0})):c({nodes:p,nodesInitialized:v})},setEdges:p=>{const{connectionLookup:b,edgeLookup:m}=h();vo(b,m,p),c({edges:p})},setDefaultNodesAndEdges:(p,b)=>{if(p){const{setNodes:m}=h();m(p),c({hasDefaultNodes:!0})}if(b){const{setEdges:m}=h();m(b),c({hasDefaultEdges:!0})}},updateNodeInternals:p=>{const{triggerNodeChanges:b,nodeLookup:m,parentLookup:N,domNode:f,nodeOrigin:w,nodeExtent:v,debug:I,fitViewQueued:_}=h(),{changes:P,updatedInternals:j}=di(p,m,N,f,w,v);j&&(ci(m,N,{nodeOrigin:w,nodeExtent:v}),_?(y(),c({fitViewQueued:!1,fitViewOptions:void 0})):c({}),(P==null?void 0:P.length)>0&&(I&&console.log("React Flow: trigger node changes",P),b==null||b(P)))},updateNodePositions:(p,b=!1)=>{const m=[],N=[],{nodeLookup:f,triggerNodeChanges:w}=h();for(const[v,I]of p){const _=f.get(v),P=!!(_!=null&&_.expandParent&&(_!=null&&_.parentId)&&(I!=null&&I.position)),j={id:v,type:"position",position:P?{x:Math.max(0,I.position.x),y:Math.max(0,I.position.y)}:I.position,dragging:b};P&&_.parentId&&m.push({id:v,parentId:_.parentId,rect:{...I.internals.positionAbsolute,width:I.measured.width??0,height:I.measured.height??0}}),N.push(j)}if(m.length>0){const{parentLookup:v,nodeOrigin:I}=h(),_=Kt(m,f,v,I);N.push(..._)}w(N)},triggerNodeChanges:p=>{const{onNodesChange:b,setNodes:m,nodes:N,hasDefaultNodes:f,debug:w}=h();if(p!=null&&p.length){if(f){const v=Lo(p,N);m(v)}w&&console.log("React Flow: trigger node changes",p),b==null||b(p)}},triggerEdgeChanges:p=>{const{onEdgesChange:b,setEdges:m,edges:N,hasDefaultEdges:f,debug:w}=h();if(p!=null&&p.length){if(f){const v=Ho(p,N);m(v)}w&&console.log("React Flow: trigger edge changes",p),b==null||b(p)}},addSelectedNodes:p=>{const{multiSelectionActive:b,edgeLookup:m,nodeLookup:N,triggerNodeChanges:f,triggerEdgeChanges:w}=h();if(b){const v=p.map(I=>ye(I,!0));f(v);return}f(Ne(N,new Set([...p]),!0)),w(Ne(m))},addSelectedEdges:p=>{const{multiSelectionActive:b,edgeLookup:m,nodeLookup:N,triggerNodeChanges:f,triggerEdgeChanges:w}=h();if(b){const v=p.map(I=>ye(I,!0));w(v);return}w(Ne(m,new Set([...p]))),f(Ne(N,new Set,!0))},unselectNodesAndEdges:({nodes:p,edges:b}={})=>{const{edges:m,nodes:N,nodeLookup:f,triggerNodeChanges:w,triggerEdgeChanges:v}=h(),I=p||N,_=b||m,P=I.map(B=>{const A=f.get(B.id);return A&&(A.selected=!1),ye(B.id,!1)}),j=_.map(B=>ye(B.id,!1));w(P),v(j)},setMinZoom:p=>{const{panZoom:b,maxZoom:m}=h();b==null||b.setScaleExtent([p,m]),c({minZoom:p})},setMaxZoom:p=>{const{panZoom:b,minZoom:m}=h();b==null||b.setScaleExtent([m,p]),c({maxZoom:p})},setTranslateExtent:p=>{var b;(b=h().panZoom)==null||b.setTranslateExtent(p),c({translateExtent:p})},setPaneClickDistance:p=>{var b;(b=h().panZoom)==null||b.setClickDistance(p)},resetSelectedElements:()=>{const{edges:p,nodes:b,triggerNodeChanges:m,triggerEdgeChanges:N,elementsSelectable:f}=h();if(!f)return;const w=b.reduce((I,_)=>_.selected?[...I,ye(_.id,!1)]:I,[]),v=p.reduce((I,_)=>_.selected?[...I,ye(_.id,!1)]:I,[]);m(w),N(v)},setNodeExtent:p=>{const{nodes:b,nodeLookup:m,parentLookup:N,nodeOrigin:f,elevateNodesOnSelect:w,nodeExtent:v}=h();p[0][0]===v[0][0]&&p[0][1]===v[0][1]&&p[1][0]===v[1][0]&&p[1][1]===v[1][1]||(Lt(b,m,N,{nodeOrigin:f,nodeExtent:p,elevateNodesOnSelect:w,checkEquality:!1}),c({nodeExtent:p}))},panBy:p=>{const{transform:b,width:m,height:N,panZoom:f,translateExtent:w}=h();return fi({delta:p,panZoom:f,transform:b,translateExtent:w,width:m,height:N})},setCenter:async(p,b,m)=>{const{width:N,height:f,maxZoom:w,panZoom:v}=h();if(!v)return Promise.resolve(!1);const I=typeof(m==null?void 0:m.zoom)<"u"?m.zoom:w;return await v.setViewport({x:N/2-p*I,y:f/2-b*I,zoom:I},{duration:m==null?void 0:m.duration,ease:m==null?void 0:m.ease,interpolate:m==null?void 0:m.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{c({connection:{...no}})},updateConnection:p=>{c({connection:p})},reset:()=>c({...Wn()})}},Object.is);function Sc({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:o,initialWidth:s,initialHeight:r,initialMinZoom:i,initialMaxZoom:a,initialFitViewOptions:l,fitView:g,nodeOrigin:u,nodeExtent:d,children:c}){const[h]=$.useState(()=>Ec({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:s,height:r,fitView:g,minZoom:i,maxZoom:a,fitViewOptions:l,nodeOrigin:u,nodeExtent:d}));return E.jsx(Oi,{value:h,children:E.jsx(fa,{children:c})})}function Nc({children:e,nodes:t,edges:n,defaultNodes:o,defaultEdges:s,width:r,height:i,fitView:a,fitViewOptions:l,minZoom:g,maxZoom:u,nodeOrigin:d,nodeExtent:c}){return $.useContext(ht)?E.jsx(E.Fragment,{children:e}):E.jsx(Sc,{initialNodes:t,initialEdges:n,defaultNodes:o,defaultEdges:s,initialWidth:r,initialHeight:i,fitView:a,initialFitViewOptions:l,initialMinZoom:g,initialMaxZoom:u,nodeOrigin:d,nodeExtent:c,children:e})}const Cc={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function Mc({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,className:s,nodeTypes:r,edgeTypes:i,onNodeClick:a,onEdgeClick:l,onInit:g,onMove:u,onMoveStart:d,onMoveEnd:c,onConnect:h,onConnectStart:y,onConnectEnd:p,onClickConnectStart:b,onClickConnectEnd:m,onNodeMouseEnter:N,onNodeMouseMove:f,onNodeMouseLeave:w,onNodeContextMenu:v,onNodeDoubleClick:I,onNodeDragStart:_,onNodeDrag:P,onNodeDragStop:j,onNodesDelete:B,onEdgesDelete:A,onDelete:L,onSelectionChange:H,onSelectionDragStart:x,onSelectionDrag:C,onSelectionDragStop:S,onSelectionContextMenu:M,onSelectionStart:z,onSelectionEnd:k,onBeforeDelete:T,connectionMode:D,connectionLineType:R=pe.Bezier,connectionLineStyle:O,connectionLineComponent:V,connectionLineContainerStyle:X,deleteKeyCode:G="Backspace",selectionKeyCode:Y="Shift",selectionOnDrag:F=!1,selectionMode:K=De.Full,panActivationKeyCode:ee="Space",multiSelectionKeyCode:Q=it()?"Meta":"Control",zoomActivationKeyCode:Z=it()?"Meta":"Control",snapToGrid:U,snapGrid:q,onlyRenderVisibleElements:te=!1,selectNodesOnDrag:se,nodesDraggable:de,autoPanOnNodeFocus:be,nodesConnectable:Xe,nodesFocusable:We,nodeOrigin:Ge=To,edgesFocusable:$e,edgesReconnectable:Ae,elementsSelectable:yt=!0,defaultViewport:Ke=na,minZoom:ve=.5,maxZoom:ze=2,translateExtent:Ut=He,preventScrolling:fs=!0,nodeExtent:xt,defaultMarkerColor:hs="#b1b1b7",zoomOnScroll:gs=!0,zoomOnPinch:ps=!0,panOnScroll:ms=!1,panOnScrollSpeed:ys=.5,panOnScrollMode:xs=xe.Free,zoomOnDoubleClick:ws=!0,panOnDrag:bs=!0,onPaneClick:vs,onPaneMouseEnter:Es,onPaneMouseMove:Ss,onPaneMouseLeave:Ns,onPaneScroll:Cs,onPaneContextMenu:Ms,paneClickDistance:Qt=0,nodeClickDistance:ks=0,children:Is,onReconnect:_s,onReconnectStart:Ps,onReconnectEnd:$s,onEdgeContextMenu:As,onEdgeDoubleClick:zs,onEdgeMouseEnter:Ts,onEdgeMouseMove:js,onEdgeMouseLeave:Ls,reconnectRadius:Hs=10,onNodesChange:Ds,onEdgesChange:Bs,noDragClassName:Rs="nodrag",noWheelClassName:Vs="nowheel",noPanClassName:Jt="nopan",fitView:en,fitViewOptions:tn,connectOnClick:Fs,attributionPosition:Os,proOptions:Ys,defaultEdgeOptions:Xs,elevateNodesOnSelect:Ws,elevateEdgesOnSelect:Gs,disableKeyboardA11y:nn=!1,autoPanOnConnect:Ks,autoPanOnNodeDrag:Zs,autoPanSpeed:qs,connectionRadius:Us,isValidConnection:Qs,onError:Js,style:er,id:on,nodeDragThreshold:tr,connectionDragThreshold:nr,viewport:or,onViewportChange:sr,width:rr,height:ir,colorMode:ar="light",debug:cr,onScroll:Ze,ariaLabelConfig:lr,...ur},dr){const wt=on||"1",fr=ia(ar),hr=$.useCallback(sn=>{sn.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),Ze==null||Ze(sn)},[Ze]);return E.jsx("div",{"data-testid":"rf__wrapper",...ur,onScroll:hr,style:{...er,...Cc},ref:dr,className:re(["react-flow",s,fr]),id:on,role:"application",children:E.jsxs(Nc,{nodes:e,edges:t,width:rr,height:ir,fitView:en,fitViewOptions:tn,minZoom:ve,maxZoom:ze,nodeOrigin:Ge,nodeExtent:xt,children:[E.jsx(vc,{onInit:g,onNodeClick:a,onEdgeClick:l,onNodeMouseEnter:N,onNodeMouseMove:f,onNodeMouseLeave:w,onNodeContextMenu:v,onNodeDoubleClick:I,nodeTypes:r,edgeTypes:i,connectionLineType:R,connectionLineStyle:O,connectionLineComponent:V,connectionLineContainerStyle:X,selectionKeyCode:Y,selectionOnDrag:F,selectionMode:K,deleteKeyCode:G,multiSelectionKeyCode:Q,panActivationKeyCode:ee,zoomActivationKeyCode:Z,onlyRenderVisibleElements:te,defaultViewport:Ke,translateExtent:Ut,minZoom:ve,maxZoom:ze,preventScrolling:fs,zoomOnScroll:gs,zoomOnPinch:ps,zoomOnDoubleClick:ws,panOnScroll:ms,panOnScrollSpeed:ys,panOnScrollMode:xs,panOnDrag:bs,onPaneClick:vs,onPaneMouseEnter:Es,onPaneMouseMove:Ss,onPaneMouseLeave:Ns,onPaneScroll:Cs,onPaneContextMenu:Ms,paneClickDistance:Qt,nodeClickDistance:ks,onSelectionContextMenu:M,onSelectionStart:z,onSelectionEnd:k,onReconnect:_s,onReconnectStart:Ps,onReconnectEnd:$s,onEdgeContextMenu:As,onEdgeDoubleClick:zs,onEdgeMouseEnter:Ts,onEdgeMouseMove:js,onEdgeMouseLeave:Ls,reconnectRadius:Hs,defaultMarkerColor:hs,noDragClassName:Rs,noWheelClassName:Vs,noPanClassName:Jt,rfId:wt,disableKeyboardA11y:nn,nodeExtent:xt,viewport:or,onViewportChange:sr}),E.jsx(ra,{nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:h,onConnectStart:y,onConnectEnd:p,onClickConnectStart:b,onClickConnectEnd:m,nodesDraggable:de,autoPanOnNodeFocus:be,nodesConnectable:Xe,nodesFocusable:We,edgesFocusable:$e,edgesReconnectable:Ae,elementsSelectable:yt,elevateNodesOnSelect:Ws,elevateEdgesOnSelect:Gs,minZoom:ve,maxZoom:ze,nodeExtent:xt,onNodesChange:Ds,onEdgesChange:Bs,snapToGrid:U,snapGrid:q,connectionMode:D,translateExtent:Ut,connectOnClick:Fs,defaultEdgeOptions:Xs,fitView:en,fitViewOptions:tn,onNodesDelete:B,onEdgesDelete:A,onDelete:L,onNodeDragStart:_,onNodeDrag:P,onNodeDragStop:j,onSelectionDrag:C,onSelectionDragStart:x,onSelectionDragStop:S,onMove:u,onMoveStart:d,onMoveEnd:c,noPanClassName:Jt,nodeOrigin:Ge,rfId:wt,autoPanOnConnect:Ks,autoPanOnNodeDrag:Zs,autoPanSpeed:qs,onError:Js,connectionRadius:Us,isValidConnection:Qs,selectNodesOnDrag:se,nodeDragThreshold:tr,connectionDragThreshold:nr,onBeforeDelete:T,paneClickDistance:Qt,debug:cr,ariaLabelConfig:lr}),E.jsx(ta,{onSelectionChange:H}),Is,E.jsx(qi,{proOptions:Ys,position:Os}),E.jsx(Zi,{rfId:wt,disableKeyboardA11y:nn})]})})}var kc=Do(Mc);function Ic(e){const[t,n]=$.useState(e),o=$.useCallback(s=>n(r=>Lo(s,r)),[]);return[t,n,o]}function _c(e){const[t,n]=$.useState(e),o=$.useCallback(s=>n(r=>Ho(s,r)),[]);return[t,n,o]}function Pc({dimensions:e,lineWidth:t,variant:n,className:o}){return E.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:re(["react-flow__background-pattern",n,o])})}function $c({radius:e,className:t}){return E.jsx("circle",{cx:e,cy:e,r:e,className:re(["react-flow__background-pattern","dots",t])})}var me;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(me||(me={}));const Ac={[me.Dots]:1,[me.Lines]:1,[me.Cross]:6},zc=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function cs({id:e,variant:t=me.Dots,gap:n=20,size:o,lineWidth:s=1,offset:r=0,color:i,bgColor:a,style:l,className:g,patternClassName:u}){const d=$.useRef(null),{transform:c,patternId:h}=J(zc,oe),y=o||Ac[t],p=t===me.Dots,b=t===me.Cross,m=Array.isArray(n)?n:[n,n],N=[m[0]*c[2]||1,m[1]*c[2]||1],f=y*c[2],w=Array.isArray(r)?r:[r,r],v=b?[f,f]:N,I=[w[0]*c[2]||1+v[0]/2,w[1]*c[2]||1+v[1]/2],_=`${h}${e||""}`;return E.jsxs("svg",{className:re(["react-flow__background",g]),style:{...l,...pt,"--xy-background-color-props":a,"--xy-background-pattern-color-props":i},ref:d,"data-testid":"rf__background",children:[E.jsx("pattern",{id:_,x:c[0]%N[0],y:c[1]%N[1],width:N[0],height:N[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${I[0]},-${I[1]})`,children:p?E.jsx($c,{radius:f/2,className:u}):E.jsx(Pc,{dimensions:v,lineWidth:s,variant:t,className:u})}),E.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${_})`})]})}cs.displayName="Background";$.memo(cs);function Tc(){return E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:E.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function jc(){return E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:E.jsx("path",{d:"M0 0h32v4.2H0z"})})}function Lc(){return E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:E.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function Hc(){return E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:E.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function Dc(){return E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:E.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function tt({children:e,className:t,...n}){return E.jsx("button",{type:"button",className:re(["react-flow__controls-button",t]),...n,children:e})}const Bc=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function ls({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:o=!0,fitViewOptions:s,onZoomIn:r,onZoomOut:i,onFitView:a,onInteractiveChange:l,className:g,children:u,position:d="bottom-left",orientation:c="vertical","aria-label":h}){const y=ne(),{isInteractive:p,minZoomReached:b,maxZoomReached:m,ariaLabelConfig:N}=J(Bc,oe),{zoomIn:f,zoomOut:w,fitView:v}=Zt(),I=()=>{f(),r==null||r()},_=()=>{w(),i==null||i()},P=()=>{v(s),a==null||a()},j=()=>{y.setState({nodesDraggable:!p,nodesConnectable:!p,elementsSelectable:!p}),l==null||l(!p)},B=c==="horizontal"?"horizontal":"vertical";return E.jsxs(gt,{className:re(["react-flow__controls",B,g]),position:d,style:e,"data-testid":"rf__controls","aria-label":h??N["controls.ariaLabel"],children:[t&&E.jsxs(E.Fragment,{children:[E.jsx(tt,{onClick:I,className:"react-flow__controls-zoomin",title:N["controls.zoomIn.ariaLabel"],"aria-label":N["controls.zoomIn.ariaLabel"],disabled:m,children:E.jsx(Tc,{})}),E.jsx(tt,{onClick:_,className:"react-flow__controls-zoomout",title:N["controls.zoomOut.ariaLabel"],"aria-label":N["controls.zoomOut.ariaLabel"],disabled:b,children:E.jsx(jc,{})})]}),n&&E.jsx(tt,{className:"react-flow__controls-fitview",onClick:P,title:N["controls.fitView.ariaLabel"],"aria-label":N["controls.fitView.ariaLabel"],children:E.jsx(Lc,{})}),o&&E.jsx(tt,{className:"react-flow__controls-interactive",onClick:j,title:N["controls.interactive.ariaLabel"],"aria-label":N["controls.interactive.ariaLabel"],children:p?E.jsx(Dc,{}):E.jsx(Hc,{})}),u]})}ls.displayName="Controls";$.memo(ls);function Rc({id:e,x:t,y:n,width:o,height:s,style:r,color:i,strokeColor:a,strokeWidth:l,className:g,borderRadius:u,shapeRendering:d,selected:c,onClick:h}){const{background:y,backgroundColor:p}=r||{},b=i||y||p;return E.jsx("rect",{className:re(["react-flow__minimap-node",{selected:c},g]),x:t,y:n,rx:u,ry:u,width:o,height:s,style:{fill:b,stroke:a,strokeWidth:l},shapeRendering:d,onClick:h?m=>h(m,e):void 0})}const Vc=$.memo(Rc),Fc=e=>e.nodes.map(t=>t.id),$t=e=>e instanceof Function?e:()=>e;function Oc({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:o=5,nodeStrokeWidth:s,nodeComponent:r=Vc,onClick:i}){const a=J(Fc,oe),l=$t(t),g=$t(e),u=$t(n),d=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return E.jsx(E.Fragment,{children:a.map(c=>E.jsx(Xc,{id:c,nodeColorFunc:l,nodeStrokeColorFunc:g,nodeClassNameFunc:u,nodeBorderRadius:o,nodeStrokeWidth:s,NodeComponent:r,onClick:i,shapeRendering:d},c))})}function Yc({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:o,nodeBorderRadius:s,nodeStrokeWidth:r,shapeRendering:i,NodeComponent:a,onClick:l}){const{node:g,x:u,y:d,width:c,height:h}=J(y=>{const{internals:p}=y.nodeLookup.get(e),b=p.userNode,{x:m,y:N}=p.positionAbsolute,{width:f,height:w}=fe(b);return{node:b,x:m,y:N,width:f,height:w}},oe);return!g||g.hidden||!lo(g)?null:E.jsx(a,{x:u,y:d,width:c,height:h,style:g.style,selected:!!g.selected,className:o(g),color:t(g),borderRadius:s,strokeColor:n(g),strokeWidth:r,shapeRendering:i,onClick:l,id:g.id})}const Xc=$.memo(Yc);var Wc=$.memo(Oc);const Gc=200,Kc=150,Zc=e=>!e.hidden,qc=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?co(Oe(e.nodeLookup,{filter:Zc}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}},Uc="react-flow__minimap-desc";function us({style:e,className:t,nodeStrokeColor:n,nodeColor:o,nodeClassName:s="",nodeBorderRadius:r=5,nodeStrokeWidth:i,nodeComponent:a,bgColor:l,maskColor:g,maskStrokeColor:u,maskStrokeWidth:d,position:c="bottom-right",onClick:h,onNodeClick:y,pannable:p=!1,zoomable:b=!1,ariaLabel:m,inversePan:N,zoomStep:f=10,offsetScale:w=5}){const v=ne(),I=$.useRef(null),{boundingRect:_,viewBB:P,rfId:j,panZoom:B,translateExtent:A,flowWidth:L,flowHeight:H,ariaLabelConfig:x}=J(qc,oe),C=(e==null?void 0:e.width)??Gc,S=(e==null?void 0:e.height)??Kc,M=_.width/C,z=_.height/S,k=Math.max(M,z),T=k*C,D=k*S,R=w*k,O=_.x-(T-_.width)/2-R,V=_.y-(D-_.height)/2-R,X=T+R*2,G=D+R*2,Y=`${Uc}-${j}`,F=$.useRef(0),K=$.useRef();F.current=k,$.useEffect(()=>{if(I.current&&B)return K.current=bi({domNode:I.current,panZoom:B,getTransform:()=>v.getState().transform,getViewScale:()=>F.current}),()=>{var U;(U=K.current)==null||U.destroy()}},[B]),$.useEffect(()=>{var U;(U=K.current)==null||U.update({translateExtent:A,width:L,height:H,inversePan:N,pannable:p,zoomStep:f,zoomable:b})},[p,b,N,f,A,L,H]);const ee=h?U=>{var se;const[q,te]=((se=K.current)==null?void 0:se.pointer(U))||[0,0];h(U,{x:q,y:te})}:void 0,Q=y?$.useCallback((U,q)=>{const te=v.getState().nodeLookup.get(q).internals.userNode;y(U,te)},[]):void 0,Z=m??x["minimap.ariaLabel"];return E.jsx(gt,{position:c,style:{...e,"--xy-minimap-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-background-color-props":typeof g=="string"?g:void 0,"--xy-minimap-mask-stroke-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-width-props":typeof d=="number"?d*k:void 0,"--xy-minimap-node-background-color-props":typeof o=="string"?o:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof i=="number"?i:void 0},className:re(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:E.jsxs("svg",{width:C,height:S,viewBox:`${O} ${V} ${X} ${G}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":Y,ref:I,onClick:ee,children:[Z&&E.jsx("title",{id:Y,children:Z}),E.jsx(Wc,{onClick:Q,nodeColor:o,nodeStrokeColor:n,nodeBorderRadius:r,nodeClassName:s,nodeStrokeWidth:i,nodeComponent:a}),E.jsx("path",{className:"react-flow__minimap-mask",d:`M${O-R},${V-R}h${X+R*2}v${G+R*2}h${-X-R*2}z
        M${P.x},${P.y}h${P.width}v${P.height}h${-P.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}us.displayName="MiniMap";$.memo(us);const Qc=e=>t=>e?`${Math.max(1/t.transform[2],1)}`:void 0,Jc={[Pe.Line]:"right",[Pe.Handle]:"bottom-right"};function el({nodeId:e,position:t,variant:n=Pe.Handle,className:o,style:s=void 0,children:r,color:i,minWidth:a=10,minHeight:l=10,maxWidth:g=Number.MAX_VALUE,maxHeight:u=Number.MAX_VALUE,keepAspectRatio:d=!1,resizeDirection:c,autoScale:h=!0,shouldResize:y,onResizeStart:p,onResize:b,onResizeEnd:m}){const N=Fo(),f=typeof e=="string"?e:N,w=ne(),v=$.useRef(null),I=n===Pe.Handle,_=J($.useCallback(Qc(I&&h),[I,h]),oe),P=$.useRef(null),j=t??Jc[n];$.useEffect(()=>{if(!(!v.current||!f))return P.current||(P.current=Li({domNode:v.current,nodeId:f,getStoreItems:()=>{const{nodeLookup:A,transform:L,snapGrid:H,snapToGrid:x,nodeOrigin:C,domNode:S}=w.getState();return{nodeLookup:A,transform:L,snapGrid:H,snapToGrid:x,nodeOrigin:C,paneDomNode:S}},onChange:(A,L)=>{const{triggerNodeChanges:H,nodeLookup:x,parentLookup:C,nodeOrigin:S}=w.getState(),M=[],z={x:A.x,y:A.y},k=x.get(f);if(k&&k.expandParent&&k.parentId){const T=k.origin??S,D=A.width??k.measured.width??0,R=A.height??k.measured.height??0,O={id:k.id,parentId:k.parentId,rect:{width:D,height:R,...uo({x:A.x??k.position.x,y:A.y??k.position.y},{width:D,height:R},k.parentId,x,T)}},V=Kt([O],x,C,S);M.push(...V),z.x=A.x?Math.max(T[0]*D,A.x):void 0,z.y=A.y?Math.max(T[1]*R,A.y):void 0}if(z.x!==void 0&&z.y!==void 0){const T={id:f,type:"position",position:{...z}};M.push(T)}if(A.width!==void 0&&A.height!==void 0){const D={id:f,type:"dimensions",resizing:!0,setAttributes:c?c==="horizontal"?"width":"height":!0,dimensions:{width:A.width,height:A.height}};M.push(D)}for(const T of L){const D={...T,type:"position"};M.push(D)}H(M)},onEnd:({width:A,height:L})=>{const H={id:f,type:"dimensions",resizing:!1,dimensions:{width:A,height:L}};w.getState().triggerNodeChanges([H])}})),P.current.update({controlPosition:j,boundaries:{minWidth:a,minHeight:l,maxWidth:g,maxHeight:u},keepAspectRatio:d,resizeDirection:c,onResizeStart:p,onResize:b,onResizeEnd:m,shouldResize:y}),()=>{var A;(A=P.current)==null||A.destroy()}},[j,a,l,g,u,d,p,b,m,y]);const B=j.split("-");return E.jsx("div",{className:re(["react-flow__resize-control","nodrag",...B,n,o]),ref:v,style:{...s,scale:_,...i&&{[I?"backgroundColor":"borderColor"]:i}},children:r})}$.memo(el);function tl(){return E.jsxs("div",{className:"p-4 bg-accent rounded-md flex flex-col gap-2",children:[E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx(Sr,{className:"size-4"}),E.jsx("input",{type:"text",placeholder:"Enter Agent Name",className:"border-none outline-none"})]}),E.jsx("p",{className:"text-sm text-muted-foreground",children:"The description of the agent"}),E.jsxs("p",{className:"font-bold flex items-center gap-2",children:[E.jsx(vr,{className:"size-4"}),E.jsx("span",{children:"Knowledge"})]}),E.jsxs(bt,{variant:"outline",className:`w-full
      `,children:[E.jsx(vt,{className:"size-4"}),"Add Knowledge"]}),E.jsxs("p",{className:"font-bold flex items-center gap-2",children:[E.jsx(rn,{className:"size-4"}),E.jsx("span",{children:"Tools"})]}),E.jsxs(bt,{variant:"outline",className:"w-full",children:[E.jsx(vt,{className:"size-4"}),"Add Tool"]}),E.jsxs("p",{className:"font-bold flex items-center gap-2",children:[E.jsx(rn,{className:"size-4"}),E.jsx("span",{children:"Handoffs"})]}),E.jsxs(bt,{variant:"outline",className:"w-full",children:[E.jsx(vt,{className:"size-4"}),"Add Handoff"]})]})}function nl({className:e,...t}){return E.jsx("textarea",{"data-slot":"textarea",className:mr("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...t})}const ds="agent-studio-graph",Gn=[{id:"1",type:"agent",position:{x:0,y:0},data:{label:"1"}},{id:"2",type:"agent",position:{x:100,y:100},data:{label:"2"}}],Kn=[],ol=()=>{try{const e=localStorage.getItem(ds);if(e){const t=JSON.parse(e);return[t.nodes||Gn,t.edges||Kn]}}catch(e){console.warn("Failed to load saved graph",e)}return[Gn,Kn]};function sl(){const[e,t]=ol(),[n,o,s]=Ic(e),[r,i,a]=_c(t),[l,g]=$.useState(null),u=$.useRef(xr((y,p)=>{console.log("Saving graph",y,p),localStorage.setItem(ds,JSON.stringify({nodes:y,edges:p}))},500)).current;$.useEffect(()=>{u(n,r)},[n,r,u]);const d=$.useCallback((y,p)=>{console.log("onNodeClick",p),g(p)},[]),c=$.useCallback(y=>i(p=>xo(y,p)),[i]),h={agent:tl};return E.jsxs("div",{children:[E.jsx(wr,{}),E.jsx("div",{style:{width:"100vw",height:"100vh"},children:E.jsx(kc,{nodes:n,edges:r,onNodesChange:s,onEdgesChange:a,onNodeClick:d,onConnect:c,nodeTypes:h})}),l&&E.jsxs(E.Fragment,{children:[E.jsx("div",{className:"absolute right-0 top-0 left-0 bottom-0",onClick:()=>g(null)}),E.jsxs("div",{className:"absolute right-0 top-0 h-[100vh] w-96 bg-sidebar",style:{width:"25%",padding:"16px",boxSizing:"border-box",overflowY:"auto"},children:[E.jsx("input",{type:"text",placeholder:"Enter Agent Name",className:"w-full text-lg font-semibold outline-none border-none mb-2"}),E.jsx("textarea",{placeholder:"Enter Agent Description",className:"w-full text-sm outline-none border-none resize-none mb-2"}),E.jsxs("div",{className:"flex flex-col gap-2",children:[E.jsx("p",{children:E.jsx("strong",{children:"System Prompt"})}),E.jsx(nl,{className:"w-full text-sm mb-2 h-48",placeholder:"Enter System Prompt"})]})]})]})]})}const ul=function(){return E.jsx(sl,{})};export{ul as component};
